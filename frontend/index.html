<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CharonSpace - 登录</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- 登录页面 -->
        <div class="container" v-if="!isLoggedIn">
            <h1>用户登录</h1>
            <div class="login-form">
                <div class="form-group">
                    <label for="username">用户名</label>
                    <input type="text" id="username" v-model="username" placeholder="请输入用户名" required>
                </div>
                <div class="form-group">
                    <label for="password">密码</label>
                    <input type="password" id="password" v-model="password" placeholder="请输入密码" required>
                </div>
                <div class="error-message" v-if="error">{{ error }}</div>
                <button class="login-btn" @click="login" :disabled="isLoading">
                    {{ isLoading ? '登录中...' : '登录' }}
                </button>
            </div>
        </div>

        <!-- 登录成功页面 -->
        <div class="app-container" v-else>
            <!-- 顶部导航栏 -->
            <header class="top-header">
                <div class="username-display">欢迎，<strong>{{ username }}</strong></div>
                <button class="logout-btn" @click="logout">登出</button>
            </header>
            
            <!-- 主内容区域 -->
            <div class="main-content">
                <!-- 左侧菜单栏 -->
                <aside class="sidebar">
                    <h2>菜单管理</h2>
                    <ul class="menu-list">
                        <!-- 动态渲染菜单 -->
                        <li v-for="parentMenu in menuTree" :key="parentMenu.id" class="menu-item parent-menu">
                            <div class="menu-title" @click="toggleMenu(getMenuKey(parentMenu))">
                                <span>{{ parentMenu.name }}</span>
                                <span class="arrow" :class="{ expanded: expandedMenus.includes(getMenuKey(parentMenu)) }">▼</span>
                            </div>
                            <ul class="submenu" v-show="expandedMenus.includes(getMenuKey(parentMenu))">
                                <li v-for="childMenu in parentMenu.children"
                                    :key="childMenu.id"
                                    class="submenu-item"
                                    :class="{ active: activeMenu === childMenu.route }"
                                    @click="setActiveMenu(childMenu.route)">
                                    {{ childMenu.name }}
                                </li>
                            </ul>
                        </li>
                    </ul>
                </aside>
                
                <!-- 右侧内容区域 -->
                <div class="content-area">
                    <!-- 学生管理页面 -->
                    <div v-if="activeMenu === 'students'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingStudents || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>
                        <div class="page-header">
                            <h1>学生管理</h1>
                            <button v-if="hasPermission('add_student')" class="add-btn" @click="openAddStudentModal">新增学生</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="studentIdFilter">ID</label>
                                    <input type="number" id="studentIdFilter" v-model="studentFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="studentNameFilter">姓名</label>
                                    <input type="text" id="studentNameFilter" v-model="studentFilters.name" placeholder="请输入姓名">
                                </div>
                                <div class="filter-item">
                                    <label for="studentGradeFilter">年级</label>
                                    <select id="studentGradeFilter" v-model="studentFilters.grade">
                                        <option value="">全部</option>
                                        <option value="一年级">一年级</option>
                                        <option value="二年级">二年级</option>
                                        <option value="三年级">三年级</option>
                                        <option value="四年级">四年级</option>
                                        <option value="五年级">五年级</option>
                                        <option value="六年级">六年级</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="studentStatusFilter">状态</label>
                                    <select id="studentStatusFilter" v-model="studentFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchStudents">搜索</button>
                                <button class="reset-btn" @click="resetStudentFilters">重置</button>
                            </div>
                        </div>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>学生姓名</th>
                                    <th>性别</th>
                                    <th>年级</th>
                                    <th>电话</th>
                                    <th>教练姓名</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="student in paginatedStudents" :key="student.id">
                                    <td>{{ student.id }}</td>
                                    <td>{{ student.student_name }}</td>
                                    <td>{{ student.sex }}</td>
                                    <td>{{ student.grade }}</td>
                                    <td>{{ student.phone }}</td>
                                    <td>{{ student.coach_names }}</td>
                                    <td>{{ student.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_student')" class="edit-btn" @click="openEditStudentModal(student)">编辑</button>
                                        <button v-if="hasPermission('enable_student') && student.status === 1" class="enable-btn" @click="updateStudentStatus(student.id, 0)">启用</button>
                                        <button v-if="hasPermission('disable_student') && student.status === 0" class="disable-btn" @click="updateStudentStatus(student.id, 1)">禁用</button>
                                        <button v-if="hasPermission('delete_student')" class="delete-btn" @click="openDeleteConfirm(student.id, 'student')">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 学生分页控件 -->
                        <div class="pagination" v-if="studentTotalPages > 1">
                            <button class="page-btn" @click="changeStudentPage(1)" :disabled="studentCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeStudentPage(studentCurrentPage - 1)" :disabled="studentCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ studentCurrentPage }} / {{ studentTotalPages }} 页</span>
                            <button class="page-btn" @click="changeStudentPage(studentCurrentPage + 1)" :disabled="studentCurrentPage === studentTotalPages">下一页</button>
                            <button class="page-btn" @click="changeStudentPage(studentTotalPages)" :disabled="studentCurrentPage === studentTotalPages">末页</button>
                        </div>
                    </div>
                    
                    <!-- 教练管理页面 -->
                    <div v-if="activeMenu === 'coaches'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingCoaches || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>
                        <div class="page-header">
                            <h1>教练管理</h1>
                            <button v-if="hasPermission('add_coach')" class="add-btn" @click="openAddCoachModal">新增教练</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="coachIdFilter">ID</label>
                                    <input type="number" id="coachIdFilter" v-model="coachFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="coachNameFilter">姓名</label>
                                    <input type="text" id="coachNameFilter" v-model="coachFilters.name" placeholder="请输入姓名">
                                </div>
                                <div class="filter-item">
                                    <label for="coachSexFilter">性别</label>
                                    <select id="coachSexFilter" v-model="coachFilters.sex">
                                        <option value="">全部</option>
                                        <option value="男">男</option>
                                        <option value="女">女</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="coachSubjectFilter">学科</label>
                                    <select id="coachSubjectFilter" v-model="coachFilters.subject">
                                        <option value="">全部</option>
                                        <option value="语文">语文</option>
                                        <option value="数学">数学</option>
                                        <option value="英语">英语</option>
                                        <option value="物理">物理</option>
                                        <option value="化学">化学</option>
                                        <option value="生物">生物</option>
                                        <option value="历史">历史</option>
                                        <option value="地理">地理</option>
                                        <option value="政治">政治</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="coachStatusFilter">状态</label>
                                    <select id="coachStatusFilter" v-model="coachFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchCoaches">搜索</button>
                                <button class="reset-btn" @click="resetCoachFilters">重置</button>
                            </div>
                        </div>
                        
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>教练姓名</th>
                                    <th>性别</th>
                                    <th>学科</th>
                                    <th>电话</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="coach in paginatedCoaches" :key="coach.id">
                                    <td>{{ coach.id }}</td>
                                    <td>{{ coach.coach_name }}</td>
                                    <td>{{ coach.sex }}</td>
                                    <td>{{ coach.subject }}</td>
                                    <td>{{ coach.phone }}</td>
                                    <td>{{ coach.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_coach')" class="edit-btn" @click="openEditCoachModal(coach)">编辑</button>
                                        <button v-if="hasPermission('enable_coach') && coach.status === 1" class="enable-btn" @click="updateCoachStatus(coach.id, 0)">启用</button>
                                        <button v-if="hasPermission('disable_coach') && coach.status === 0" class="disable-btn" @click="updateCoachStatus(coach.id, 1)">禁用</button>
                                        <button v-if="hasPermission('delete_coach')" class="delete-btn" @click="openDeleteConfirm(coach.id, 'coach')">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 教练分页控件 -->
                        <div class="pagination" v-if="coachTotalPages > 1">
                            <button class="page-btn" @click="changeCoachPage(1)" :disabled="coachCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeCoachPage(coachCurrentPage - 1)" :disabled="coachCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ coachCurrentPage }} / {{ coachTotalPages }} 页</span>
                            <button class="page-btn" @click="changeCoachPage(coachCurrentPage + 1)" :disabled="coachCurrentPage === coachTotalPages">下一页</button>
                            <button class="page-btn" @click="changeCoachPage(coachTotalPages)" :disabled="coachCurrentPage === coachTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 订单管理页面 -->
                    <div v-if="activeMenu === 'orders'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingOrders || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>
                        <div class="page-header">
                            <h1>订单管理</h1>
                            <button v-if="hasPermission('add_order')" class="add-btn" @click="openAddOrderDrawer">新增订单</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="orderIdFilter">ID</label>
                                    <input type="number" id="orderIdFilter" v-model="orderFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="orderUidFilter">UID</label>
                                    <input type="number" id="orderUidFilter" v-model="orderFilters.uid" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="orderStatusFilter">状态</label>
                                    <select id="orderStatusFilter" v-model="orderFilters.status">
                                        <option value="">全部</option>
                                        <option value="10">草稿</option>
                                        <option value="20">未支付</option>
                                        <option value="30">部分支付</option>
                                        <option value="40">已支付</option>
                                        <option value="50">退费中</option>
                                        <option value="99">已作废</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchOrders">搜索</button>
                                <button class="reset-btn" @click="resetOrderFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>下单时间</th>
                                    <th>姓名</th>
                                    <th>应收金额</th>
                                    <th>优惠金额</th>
                                    <th>实收金额</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="order in paginatedOrders" :key="order.id">
                                    <td>{{ order.id }}</td>
                                    <td>{{ order.uid }}</td>
                                    <td>{{ order.create_time }}</td>
                                    <td>{{ order.student_name }}</td>
                                    <td>{{ order.amount_receivable }}</td>
                                    <td style="color: #e74c3c;">{{ order.discount_amount || '0.00' }}</td>
                                    <td style="font-weight: bold;">{{ order.amount_received }}</td>
                                    <td>{{ getOrderStatusText(order.status) }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_order') && order.status === 10" class="edit-btn" @click="openEditOrderDrawer(order)">编辑</button>
                                        <button v-if="hasPermission('void_order') && order.status === 10" class="delete-btn" @click="openCancelOrderConfirm(order.id)">作废</button>
                                        <button v-if="[20, 30, 40, 50].includes(order.status)" class="view-btn" @click="openOrderDetailDrawer(order)">详情</button>
                                        <button v-if="hasPermission('apply_refund') && (order.status === 30 || order.status === 40)" class="refund-btn" @click="openRefundDialog(order.id)">申请退费</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 订单分页控件 -->
                        <div class="pagination" v-if="orderTotalPages > 1">
                            <button class="page-btn" @click="changeOrderPage(1)" :disabled="orderCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeOrderPage(orderCurrentPage - 1)" :disabled="orderCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ orderCurrentPage }} / {{ orderTotalPages }} 页</span>
                            <button class="page-btn" @click="changeOrderPage(orderCurrentPage + 1)" :disabled="orderCurrentPage === orderTotalPages">下一页</button>
                            <button class="page-btn" @click="changeOrderPage(orderTotalPages)" :disabled="orderCurrentPage === orderTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 子订单页面 -->
                    <div v-if="activeMenu === 'childorders'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingChildOrders" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>子订单</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="childOrderIdFilter">ID</label>
                                    <input type="number" id="childOrderIdFilter" v-model="childOrderFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="childOrderParentIdFilter">订单ID</label>
                                    <input type="number" id="childOrderParentIdFilter" v-model="childOrderFilters.parentsid" placeholder="请输入订单ID">
                                </div>
                                <div class="filter-item">
                                    <label for="childOrderGoodsIdFilter">商品ID</label>
                                    <input type="number" id="childOrderGoodsIdFilter" v-model="childOrderFilters.goodsid" placeholder="请输入商品ID">
                                </div>
                                <div class="filter-item">
                                    <label for="childOrderStatusFilter">订单状态</label>
                                    <select id="childOrderStatusFilter" v-model="childOrderFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">草稿</option>
                                        <option value="10">未支付</option>
                                        <option value="20">部分支付</option>
                                        <option value="30">已支付</option>
                                        <option value="99">已作废</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchChildOrders">搜索</button>
                                <button class="reset-btn" @click="resetChildOrderFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>订单ID</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>应收金额</th>
                                    <th>优惠金额</th>
                                    <th>实收金额</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="childOrder in paginatedChildOrders" :key="childOrder.id">
                                    <td>{{ childOrder.id }}</td>
                                    <td>{{ childOrder.parentsid }}</td>
                                    <td>{{ childOrder.goodsid }}</td>
                                    <td>{{ childOrder.goods_name }}</td>
                                    <td>{{ childOrder.amount_receivable }}</td>
                                    <td style="color: #e74c3c;">{{ childOrder.discount_amount || '0.00' }}</td>
                                    <td style="font-weight: bold;">{{ childOrder.amount_received }}</td>
                                    <td>{{ getChildOrderStatusText(childOrder.status) }}</td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 子订单分页控件 -->
                        <div class="pagination" v-if="childOrderTotalPages > 1">
                            <button class="page-btn" @click="changeChildOrderPage(1)" :disabled="childOrderCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeChildOrderPage(childOrderCurrentPage - 1)" :disabled="childOrderCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ childOrderCurrentPage }} / {{ childOrderTotalPages }} 页</span>
                            <button class="page-btn" @click="changeChildOrderPage(childOrderCurrentPage + 1)" :disabled="childOrderCurrentPage === childOrderTotalPages">下一页</button>
                            <button class="page-btn" @click="changeChildOrderPage(childOrderTotalPages)" :disabled="childOrderCurrentPage === childOrderTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 退款订单页面 -->
                    <div v-if="activeMenu === 'refund_orders'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingRefundOrders" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>退款订单</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="refundOrderIdFilter">ID</label>
                                    <input type="number" id="refundOrderIdFilter" v-model="refundOrderFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundOrderUidFilter">UID</label>
                                    <input type="number" id="refundOrderUidFilter" v-model="refundOrderFilters.uid" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundOrderOrderIdFilter">订单ID</label>
                                    <input type="number" id="refundOrderOrderIdFilter" v-model="refundOrderFilters.order_id" placeholder="请输入订单ID">
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchRefundOrders">搜索</button>
                                <button class="reset-btn" @click="resetRefundOrderFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>订单ID</th>
                                    <th>退费金额</th>
                                    <th>提交人</th>
                                    <th>提交时间</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="refundOrder in paginatedRefundOrders" :key="refundOrder.id">
                                    <td>{{ refundOrder.id }}</td>
                                    <td>{{ refundOrder.uid }}</td>
                                    <td>{{ refundOrder.order_id }}</td>
                                    <td style="font-weight: bold; color: #e74c3c;">{{ refundOrder.refund_amount }}</td>
                                    <td>{{ refundOrder.submitter }}</td>
                                    <td>{{ refundOrder.submit_time }}</td>
                                    <td>{{ getRefundOrderStatusText(refundOrder.status) }}</td>
                                    <td class="action-column">
                                        <button class="edit-btn" @click="openRefundOrderDetail(refundOrder.id)">详情</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 退款订单分页控件 -->
                        <div class="pagination" v-if="refundOrderTotalPages > 1">
                            <button class="page-btn" @click="changeRefundOrderPage(1)" :disabled="refundOrderCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeRefundOrderPage(refundOrderCurrentPage - 1)" :disabled="refundOrderCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ refundOrderCurrentPage }} / {{ refundOrderTotalPages }} 页</span>
                            <button class="page-btn" @click="changeRefundOrderPage(refundOrderCurrentPage + 1)" :disabled="refundOrderCurrentPage === refundOrderTotalPages">下一页</button>
                            <button class="page-btn" @click="changeRefundOrderPage(refundOrderTotalPages)" :disabled="refundOrderCurrentPage === refundOrderTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 子退费订单页面 -->
                    <div v-if="activeMenu === 'refund_childorders'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingRefundChildOrders" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>子退费订单</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="refundChildOrderIdFilter">ID</label>
                                    <input type="number" id="refundChildOrderIdFilter" v-model="refundChildOrderFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundChildOrderUidFilter">UID</label>
                                    <input type="number" id="refundChildOrderUidFilter" v-model="refundChildOrderFilters.student_id" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundChildOrderOrderIdFilter">订单ID</label>
                                    <input type="number" id="refundChildOrderOrderIdFilter" v-model="refundChildOrderFilters.order_id" placeholder="请输入订单ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundChildOrderGoodsIdFilter">商品ID</label>
                                    <input type="number" id="refundChildOrderGoodsIdFilter" v-model="refundChildOrderFilters.goods_id" placeholder="请输入商品ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundChildOrderStatusFilter">状态</label>
                                    <select id="refundChildOrderStatusFilter" v-model="refundChildOrderFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">退费中</option>
                                        <option value="10">已通过</option>
                                        <option value="20">已驳回</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchRefundChildOrders">搜索</button>
                                <button class="reset-btn" @click="resetRefundChildOrderFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>订单ID</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>退费金额</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in paginatedRefundChildOrders" :key="item.id">
                                    <td>{{ item.id }}</td>
                                    <td>{{ item.uid }}</td>
                                    <td>{{ item.order_id }}</td>
                                    <td>{{ item.goods_id }}</td>
                                    <td>{{ item.goods_name }}</td>
                                    <td style="font-weight: bold; color: #e74c3c;">{{ item.refund_amount }}</td>
                                    <td>{{ getRefundOrderStatusText(item.status) }}</td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 子退费订单分页控件 -->
                        <div class="pagination" v-if="refundChildOrderTotalPages > 1">
                            <button class="page-btn" @click="changeRefundChildOrderPage(1)" :disabled="refundChildOrderCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeRefundChildOrderPage(refundChildOrderCurrentPage - 1)" :disabled="refundChildOrderCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ refundChildOrderCurrentPage }} / {{ refundChildOrderTotalPages }} 页</span>
                            <button class="page-btn" @click="changeRefundChildOrderPage(refundChildOrderCurrentPage + 1)" :disabled="refundChildOrderCurrentPage === refundChildOrderTotalPages">下一页</button>
                            <button class="page-btn" @click="changeRefundChildOrderPage(refundChildOrderTotalPages)" :disabled="refundChildOrderCurrentPage === refundChildOrderTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 审批流类型页面 -->
                    <div v-if="activeMenu === 'approval_flow_type'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingApprovalFlowTypes || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>审批流类型</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="flowTypeIdFilter">ID</label>
                                    <input type="number" id="flowTypeIdFilter" v-model="approvalFlowTypeFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="flowTypeNameFilter">类型名称</label>
                                    <select id="flowTypeNameFilter" v-model="approvalFlowTypeFilters.name">
                                        <option value="">全部</option>
                                        <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.name">{{ type.name }}</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="flowTypeStatusFilter">状态</label>
                                    <select id="flowTypeStatusFilter" v-model="approvalFlowTypeFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchApprovalFlowTypes">搜索</button>
                                <button class="reset-btn" @click="resetApprovalFlowTypeFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>名称</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="flowType in paginatedApprovalFlowTypes" :key="flowType.id">
                                    <td>{{ flowType.id }}</td>
                                    <td>{{ flowType.name }}</td>
                                    <td>{{ flowType.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('enable_approval_type') && flowType.status === 1" class="enable-btn" @click="openEnableFlowTypeConfirm(flowType)">启用</button>
                                        <button v-if="hasPermission('disable_approval_type') && flowType.status === 0" class="disable-btn" @click="openDisableFlowTypeConfirm(flowType)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 分页控件 -->
                        <div class="pagination" v-if="approvalFlowTypeTotalPages > 1">
                            <button class="page-btn" @click="changeApprovalFlowTypePage(1)" :disabled="approvalFlowTypeCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeApprovalFlowTypePage(approvalFlowTypeCurrentPage - 1)" :disabled="approvalFlowTypeCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ approvalFlowTypeCurrentPage }} / {{ approvalFlowTypeTotalPages }} 页</span>
                            <button class="page-btn" @click="changeApprovalFlowTypePage(approvalFlowTypeCurrentPage + 1)" :disabled="approvalFlowTypeCurrentPage === approvalFlowTypeTotalPages">下一页</button>
                            <button class="page-btn" @click="changeApprovalFlowTypePage(approvalFlowTypeTotalPages)" :disabled="approvalFlowTypeCurrentPage === approvalFlowTypeTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 审批流模板页面 -->
                    <div v-if="activeMenu === 'approval_flow_template'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingApprovalFlowTemplates || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>审批流模板</h1>
                            <button v-if="hasPermission('add_approval_template')" class="add-btn" @click="openAddApprovalFlowTemplateDrawer">新增审批流</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="flowTemplateIdFilter">ID</label>
                                    <input type="number" id="flowTemplateIdFilter" v-model="approvalFlowTemplateFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="flowTemplateTypeFilter">审批流类型</label>
                                    <select id="flowTemplateTypeFilter" v-model="approvalFlowTemplateFilters.approval_flow_type_id">
                                        <option value="">全部</option>
                                        <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="flowTemplateNameFilter">模板名称</label>
                                    <input type="text" id="flowTemplateNameFilter" v-model="approvalFlowTemplateFilters.name" placeholder="请输入模板名称">
                                </div>
                                <div class="filter-item">
                                    <label for="flowTemplateStatusFilter">状态</label>
                                    <select id="flowTemplateStatusFilter" v-model="approvalFlowTemplateFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchApprovalFlowTemplates">搜索</button>
                                <button class="reset-btn" @click="resetApprovalFlowTemplateFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>审批流类型</th>
                                    <th>模板名称</th>
                                    <th>创建人</th>
                                    <th>创建时间</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="template in paginatedApprovalFlowTemplates" :key="template.id">
                                    <td>{{ template.id }}</td>
                                    <td>{{ template.flow_type_name }}</td>
                                    <td>{{ template.name }}</td>
                                    <td>{{ template.creator }}</td>
                                    <td>{{ template.create_time }}</td>
                                    <td>{{ template.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button class="view-btn" @click="openViewApprovalFlowTemplateDrawer(template)">详情</button>
                                        <button v-if="hasPermission('enable_approval_template') && template.status === 1" class="enable-btn" @click="openEnableFlowTemplateConfirm(template)">启用</button>
                                        <button v-if="hasPermission('disable_approval_template') && template.status === 0" class="disable-btn" @click="openDisableFlowTemplateConfirm(template)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 分页控件 -->
                        <div class="pagination" v-if="approvalFlowTemplateTotalPages > 1">
                            <button class="page-btn" @click="changeApprovalFlowTemplatePage(1)" :disabled="approvalFlowTemplateCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeApprovalFlowTemplatePage(approvalFlowTemplateCurrentPage - 1)" :disabled="approvalFlowTemplateCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ approvalFlowTemplateCurrentPage }} / {{ approvalFlowTemplateTotalPages }} 页</span>
                            <button class="page-btn" @click="changeApprovalFlowTemplatePage(approvalFlowTemplateCurrentPage + 1)" :disabled="approvalFlowTemplateCurrentPage === approvalFlowTemplateTotalPages">下一页</button>
                            <button class="page-btn" @click="changeApprovalFlowTemplatePage(approvalFlowTemplateTotalPages)" :disabled="approvalFlowTemplateCurrentPage === approvalFlowTemplateTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 权限管理页面 -->
                    <div v-if="activeMenu === 'permissions'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>权限管理</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="permissionIdFilter">ID</label>
                                    <input type="number" id="permissionIdFilter" v-model="permissionFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="permissionMenuFilter">所在菜单</label>
                                    <select id="permissionMenuFilter" v-model="permissionFilters.menu_id">
                                        <option value="">全部</option>
                                        <option v-for="menu in secondLevelMenus" :key="menu.id" :value="menu.id">{{ menu.name }}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchPermissions">搜索</button>
                                <button class="reset-btn" @click="resetPermissionFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>权限名称</th>
                                    <th>所在菜单</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="permission in paginatedPermissions" :key="permission.id">
                                    <td>{{ permission.id }}</td>
                                    <td>{{ permission.name }}</td>
                                    <td>{{ permission.menu_name }}</td>
                                    <td>{{ permission.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="permission.status === 1" class="enable-btn" @click="openEnablePermissionConfirm(permission)">启用</button>
                                        <button v-if="permission.status === 0" class="disable-btn" @click="openDisablePermissionConfirm(permission)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 分页控件 -->
                        <div class="pagination" v-if="permissionTotalPages > 1">
                            <button class="page-btn" @click="changePermissionPage(1)" :disabled="permissionCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changePermissionPage(permissionCurrentPage - 1)" :disabled="permissionCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ permissionCurrentPage }} / {{ permissionTotalPages }} 页</span>
                            <button class="page-btn" @click="changePermissionPage(permissionCurrentPage + 1)" :disabled="permissionCurrentPage === permissionTotalPages">下一页</button>
                            <button class="page-btn" @click="changePermissionPage(permissionTotalPages)" :disabled="permissionCurrentPage === permissionTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 审批流管理页面 -->
                    <div v-if="activeMenu === 'approval_flow_management'" style="position: relative;">
                        <div class="page-header">
                            <h1>审批流管理</h1>
                        </div>

                        <!-- Tab导航 -->
                        <div class="tab-nav">
                            <button class="tab-btn" :class="{active: approvalFlowManagementTab === 'initiated'}" @click="approvalFlowManagementTab = 'initiated'; fetchInitiatedFlows();">我发起的</button>
                            <button class="tab-btn" :class="{active: approvalFlowManagementTab === 'pending'}" @click="approvalFlowManagementTab = 'pending'; fetchPendingFlows();">待我审批</button>
                            <button class="tab-btn" :class="{active: approvalFlowManagementTab === 'completed'}" @click="approvalFlowManagementTab = 'completed'; fetchCompletedFlows();">处理完成</button>
                            <button class="tab-btn" :class="{active: approvalFlowManagementTab === 'copied'}" @click="approvalFlowManagementTab = 'copied'; fetchCopiedFlows();">抄送我的</button>
                        </div>

                        <!-- 我发起的 Tab -->
                        <div v-if="approvalFlowManagementTab === 'initiated'" style="position: relative;">
                            <!-- Loading遮罩层 -->
                            <div v-if="loadingInitiatedFlows" class="loading-overlay">
                                <div class="loading-spinner"></div>
                                <div class="loading-text">加载中...</div>
                            </div>

                            <!-- 筛选表单 -->
                            <div class="filter-form">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label for="initiatedFlowIdFilter">ID</label>
                                        <input type="number" id="initiatedFlowIdFilter" v-model="initiatedFlowFilters.id" placeholder="请输入ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="initiatedFlowTypeFilter">审批流类型</label>
                                        <select id="initiatedFlowTypeFilter" v-model="initiatedFlowFilters.approval_flow_type_id">
                                            <option value="">全部</option>
                                            <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                                        </select>
                                    </div>
                                    <div class="filter-item">
                                        <label for="initiatedFlowStatusFilter">状态</label>
                                        <select id="initiatedFlowStatusFilter" v-model="initiatedFlowFilters.status">
                                            <option value="">全部</option>
                                            <option value="0">待审批</option>
                                            <option value="10">已通过</option>
                                            <option value="20">已驳回</option>
                                            <option value="99">已撤销</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="filter-actions">
                                    <button class="search-btn" @click="searchInitiatedFlows">搜索</button>
                                    <button class="reset-btn" @click="resetInitiatedFlowFilters">重置</button>
                                </div>
                            </div>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>审批流类型</th>
                                        <th>当前节点步骤</th>
                                        <th>创建时间</th>
                                        <th>状态</th>
                                        <th>完成时间</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="flow in paginatedInitiatedFlows" :key="flow.id">
                                        <td>{{ flow.id }}</td>
                                        <td>{{ flow.approval_flow_type_name }}</td>
                                        <td>{{ flow.step }}</td>
                                        <td>{{ flow.create_time }}</td>
                                        <td>{{ getFlowStatusText(flow.status) }}</td>
                                        <td>{{ flow.complete_time || '-' }}</td>
                                        <td class="action-column">
                                            <button v-if="flow.status === 0" class="delete-btn" @click="openCancelFlowConfirm(flow)">撤销</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- 分页控件 -->
                            <div class="pagination" v-if="initiatedFlowTotalPages > 1">
                                <button class="page-btn" @click="changeInitiatedFlowPage(1)" :disabled="initiatedFlowCurrentPage === 1">首页</button>
                                <button class="page-btn" @click="changeInitiatedFlowPage(initiatedFlowCurrentPage - 1)" :disabled="initiatedFlowCurrentPage === 1">上一页</button>
                                <span class="page-info">第 {{ initiatedFlowCurrentPage }} / {{ initiatedFlowTotalPages }} 页</span>
                                <button class="page-btn" @click="changeInitiatedFlowPage(initiatedFlowCurrentPage + 1)" :disabled="initiatedFlowCurrentPage === initiatedFlowTotalPages">下一页</button>
                                <button class="page-btn" @click="changeInitiatedFlowPage(initiatedFlowTotalPages)" :disabled="initiatedFlowCurrentPage === initiatedFlowTotalPages">末页</button>
                            </div>
                        </div>

                        <!-- 待我审批 Tab -->
                        <div v-if="approvalFlowManagementTab === 'pending'" style="position: relative;">
                            <!-- Loading遮罩层 -->
                            <div v-if="loadingPendingFlows" class="loading-overlay">
                                <div class="loading-spinner"></div>
                                <div class="loading-text">加载中...</div>
                            </div>

                            <!-- 筛选表单 -->
                            <div class="filter-form">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label for="pendingFlowIdFilter">ID</label>
                                        <input type="number" id="pendingFlowIdFilter" v-model="pendingFlowFilters.id" placeholder="请输入ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="pendingFlowFlowIdFilter">审批流ID</label>
                                        <input type="number" id="pendingFlowFlowIdFilter" v-model="pendingFlowFilters.approval_flow_id" placeholder="请输入审批流ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="pendingFlowTypeFilter">审批流类型</label>
                                        <select id="pendingFlowTypeFilter" v-model="pendingFlowFilters.approval_flow_type_id">
                                            <option value="">全部</option>
                                            <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="filter-actions">
                                    <button class="search-btn" @click="searchPendingFlows">搜索</button>
                                    <button class="reset-btn" @click="resetPendingFlowFilters">重置</button>
                                </div>
                            </div>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>审批流ID</th>
                                        <th>审批流类型</th>
                                        <th>节点类型</th>
                                        <th>节点排序</th>
                                        <th>创建时间</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="flow in paginatedPendingFlows" :key="flow.id">
                                        <td>{{ flow.id }}</td>
                                        <td>{{ flow.approval_flow_management_id }}</td>
                                        <td>{{ flow.approval_flow_type_name }}</td>
                                        <td>{{ flow.node_type === 0 ? '会签' : '或签' }}</td>
                                        <td>{{ flow.node_sort }}</td>
                                        <td>{{ flow.create_time }}</td>
                                        <td class="action-column">
                                            <button class="view-btn" @click="openApprovalDetail(flow)">详情</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- 分页控件 -->
                            <div class="pagination" v-if="pendingFlowTotalPages > 1">
                                <button class="page-btn" @click="changePendingFlowPage(1)" :disabled="pendingFlowCurrentPage === 1">首页</button>
                                <button class="page-btn" @click="changePendingFlowPage(pendingFlowCurrentPage - 1)" :disabled="pendingFlowCurrentPage === 1">上一页</button>
                                <span class="page-info">第 {{ pendingFlowCurrentPage }} / {{ pendingFlowTotalPages }} 页</span>
                                <button class="page-btn" @click="changePendingFlowPage(pendingFlowCurrentPage + 1)" :disabled="pendingFlowCurrentPage === pendingFlowTotalPages">下一页</button>
                                <button class="page-btn" @click="changePendingFlowPage(pendingFlowTotalPages)" :disabled="pendingFlowCurrentPage === pendingFlowTotalPages">末页</button>
                            </div>
                        </div>

                        <!-- 处理完成 Tab -->
                        <div v-if="approvalFlowManagementTab === 'completed'" style="position: relative;">
                            <!-- Loading遮罩层 -->
                            <div v-if="loadingCompletedFlows" class="loading-overlay">
                                <div class="loading-spinner"></div>
                                <div class="loading-text">加载中...</div>
                            </div>

                            <!-- 筛选表单 -->
                            <div class="filter-form">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label for="completedFlowIdFilter">ID</label>
                                        <input type="number" id="completedFlowIdFilter" v-model="completedFlowFilters.id" placeholder="请输入ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="completedFlowFlowIdFilter">审批流ID</label>
                                        <input type="number" id="completedFlowFlowIdFilter" v-model="completedFlowFilters.approval_flow_id" placeholder="请输入审批流ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="completedFlowTypeFilter">审批流类型</label>
                                        <select id="completedFlowTypeFilter" v-model="completedFlowFilters.approval_flow_type_id">
                                            <option value="">全部</option>
                                            <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="filter-actions">
                                    <button class="search-btn" @click="searchCompletedFlows">搜索</button>
                                    <button class="reset-btn" @click="resetCompletedFlowFilters">重置</button>
                                </div>
                            </div>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>审批流ID</th>
                                        <th>审批流类型</th>
                                        <th>节点类型</th>
                                        <th>节点排序</th>
                                        <th>审批结果</th>
                                        <th>处理时间</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="flow in paginatedCompletedFlows" :key="flow.id">
                                        <td>{{ flow.id }}</td>
                                        <td>{{ flow.approval_flow_management_id }}</td>
                                        <td>{{ flow.approval_flow_type_name }}</td>
                                        <td>{{ flow.node_type === 0 ? '会签' : '或签' }}</td>
                                        <td>{{ flow.node_sort }}</td>
                                        <td>{{ getApprovalResultText(flow.result) }}</td>
                                        <td>{{ flow.handle_time }}</td>
                                        <td class="action-column">
                                            <button class="view-btn" @click="openApprovalDetail(flow)">详情</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- 分页控件 -->
                            <div class="pagination" v-if="completedFlowTotalPages > 1">
                                <button class="page-btn" @click="changeCompletedFlowPage(1)" :disabled="completedFlowCurrentPage === 1">首页</button>
                                <button class="page-btn" @click="changeCompletedFlowPage(completedFlowCurrentPage - 1)" :disabled="completedFlowCurrentPage === 1">上一页</button>
                                <span class="page-info">第 {{ completedFlowCurrentPage }} / {{ completedFlowTotalPages }} 页</span>
                                <button class="page-btn" @click="changeCompletedFlowPage(completedFlowCurrentPage + 1)" :disabled="completedFlowCurrentPage === completedFlowTotalPages">下一页</button>
                                <button class="page-btn" @click="changeCompletedFlowPage(completedFlowTotalPages)" :disabled="completedFlowCurrentPage === completedFlowTotalPages">末页</button>
                            </div>
                        </div>

                        <!-- 抄送我的 Tab -->
                        <div v-if="approvalFlowManagementTab === 'copied'" style="position: relative;">
                            <!-- Loading遮罩层 -->
                            <div v-if="loadingCopiedFlows" class="loading-overlay">
                                <div class="loading-spinner"></div>
                                <div class="loading-text">加载中...</div>
                            </div>

                            <!-- 筛选表单 -->
                            <div class="filter-form">
                                <div class="filter-row">
                                    <div class="filter-item">
                                        <label for="copiedFlowIdFilter">ID</label>
                                        <input type="number" id="copiedFlowIdFilter" v-model="copiedFlowFilters.id" placeholder="请输入ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="copiedFlowFlowIdFilter">审批流ID</label>
                                        <input type="number" id="copiedFlowFlowIdFilter" v-model="copiedFlowFilters.approval_flow_id" placeholder="请输入审批流ID">
                                    </div>
                                    <div class="filter-item">
                                        <label for="copiedFlowTypeFilter">审批流类型</label>
                                        <select id="copiedFlowTypeFilter" v-model="copiedFlowFilters.approval_flow_type_id">
                                            <option value="">全部</option>
                                            <option v-for="type in approvalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="filter-actions">
                                    <button class="search-btn" @click="searchCopiedFlows">搜索</button>
                                    <button class="reset-btn" @click="resetCopiedFlowFilters">重置</button>
                                </div>
                            </div>

                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>审批流ID</th>
                                        <th>审批流类型</th>
                                        <th>抄送信息</th>
                                        <th>创建时间</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="flow in paginatedCopiedFlows" :key="flow.id">
                                        <td>{{ flow.id }}</td>
                                        <td>{{ flow.approval_flow_id }}</td>
                                        <td>{{ flow.approval_flow_type_name }}</td>
                                        <td>{{ flow.copy_info }}</td>
                                        <td>{{ flow.create_time }}</td>
                                        <td class="action-column">
                                            <button class="view-btn" @click="openApprovalDetail(flow)">详情</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- 分页控件 -->
                            <div class="pagination" v-if="copiedFlowTotalPages > 1">
                                <button class="page-btn" @click="changeCopiedFlowPage(1)" :disabled="copiedFlowCurrentPage === 1">首页</button>
                                <button class="page-btn" @click="changeCopiedFlowPage(copiedFlowCurrentPage - 1)" :disabled="copiedFlowCurrentPage === 1">上一页</button>
                                <span class="page-info">第 {{ copiedFlowCurrentPage }} / {{ copiedFlowTotalPages }} 页</span>
                                <button class="page-btn" @click="changeCopiedFlowPage(copiedFlowCurrentPage + 1)" :disabled="copiedFlowCurrentPage === copiedFlowTotalPages">下一页</button>
                                <button class="page-btn" @click="changeCopiedFlowPage(copiedFlowTotalPages)" :disabled="copiedFlowCurrentPage === copiedFlowTotalPages">末页</button>
                            </div>
                        </div>
                    </div>

                    <!-- 活动模板页面 -->
                    <div v-if="activeMenu === 'activity_template'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingActivityTemplates || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>活动模板</h1>
                            <button v-if="hasPermission('add_activity_template')" class="add-btn" @click="openAddActivityTemplateDrawer">新增模板</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="templateIdFilter">ID</label>
                                    <input type="number" id="templateIdFilter" v-model="activityTemplateFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="templateNameFilter">模板名称</label>
                                    <input type="text" id="templateNameFilter" v-model="activityTemplateFilters.name" placeholder="请输入模板名称">
                                </div>
                                <div class="filter-item">
                                    <label for="templateTypeFilter">活动类型</label>
                                    <select id="templateTypeFilter" v-model="activityTemplateFilters.type">
                                        <option value="">全部</option>
                                        <option value="1">满减</option>
                                        <option value="2">满折</option>
                                        <option value="3">满赠</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="templateStatusFilter">状态</label>
                                    <select id="templateStatusFilter" v-model="activityTemplateFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchActivityTemplates">搜索</button>
                                <button class="reset-btn" @click="resetActivityTemplateFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>模板名称</th>
                                    <th>活动类型</th>
                                    <th>选择方式</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="template in paginatedActivityTemplates" :key="template.id">
                                    <td>{{ template.id }}</td>
                                    <td>{{ template.name }}</td>
                                    <td>{{ getActivityTypeText(template.type) }}</td>
                                    <td>{{ template.select_type === 1 ? '按类型' : '按商品' }}</td>
                                    <td>{{ template.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button class="edit-btn" @click="openActivityTemplateDetailDrawer(template)">详情</button>
                                        <button v-if="hasPermission('enable_activity_template') && template.status === 1" class="enable-btn" @click="updateActivityTemplateStatus(template.id, 0)">启用</button>
                                        <button v-if="hasPermission('disable_activity_template') && template.status === 0" class="disable-btn" @click="updateActivityTemplateStatus(template.id, 1)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 活动模板分页控件 -->
                        <div class="pagination" v-if="activityTemplateTotalPages > 1">
                            <button class="page-btn" @click="changeActivityTemplatePage(1)" :disabled="activityTemplateCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeActivityTemplatePage(activityTemplateCurrentPage - 1)" :disabled="activityTemplateCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ activityTemplateCurrentPage }} / {{ activityTemplateTotalPages }} 页</span>
                            <button class="page-btn" @click="changeActivityTemplatePage(activityTemplateCurrentPage + 1)" :disabled="activityTemplateCurrentPage === activityTemplateTotalPages">下一页</button>
                            <button class="page-btn" @click="changeActivityTemplatePage(activityTemplateTotalPages)" :disabled="activityTemplateCurrentPage === activityTemplateTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 活动管理页面 -->
                    <div v-if="activeMenu === 'activity_management'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingActivities || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>活动管理</h1>
                            <button v-if="hasPermission('add_activity')" class="add-btn" @click="openAddActivityDrawer">新增活动</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="activityIdFilter">ID</label>
                                    <input type="number" id="activityIdFilter" v-model="activityFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="activityNameFilter">活动名称</label>
                                    <input type="text" id="activityNameFilter" v-model="activityFilters.name" placeholder="请输入活动名称">
                                </div>
                                <div class="filter-item">
                                    <label for="activityTemplateFilter">活动模板</label>
                                    <select id="activityTemplateFilter" v-model="activityFilters.template_id">
                                        <option value="">全部</option>
                                        <option v-for="t in activityTemplates" :key="t.id" :value="t.id">{{ t.name }}</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="activityStatusFilter">状态</label>
                                    <select id="activityStatusFilter" v-model="activityFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchActivities">搜索</button>
                                <button class="reset-btn" @click="resetActivityFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>活动名称</th>
                                    <th>关联模板</th>
                                    <th>活动类型</th>
                                    <th>开始时间</th>
                                    <th>结束时间</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="activity in paginatedActivities" :key="activity.id">
                                    <td>{{ activity.id }}</td>
                                    <td>{{ activity.name }}</td>
                                    <td>{{ activity.template_name }}</td>
                                    <td>{{ getActivityTypeText(activity.template_type) }}</td>
                                    <td>{{ formatDateTime(activity.start_time) }}</td>
                                    <td>{{ formatDateTime(activity.end_time) }}</td>
                                    <td>{{ activity.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button class="edit-btn" @click="openActivityDetailDrawer(activity)">详情</button>
                                        <button v-if="hasPermission('edit_activity') && activity.status === 1" class="edit-btn" @click="openEditActivityDrawer(activity)">编辑</button>
                                        <button v-if="hasPermission('enable_activity') && activity.status === 1" class="enable-btn" @click="updateActivityStatus(activity.id, 0)">启用</button>
                                        <button v-if="hasPermission('disable_activity') && activity.status === 0" class="disable-btn" @click="updateActivityStatus(activity.id, 1)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 活动分页控件 -->
                        <div class="pagination" v-if="activityTotalPages > 1">
                            <button class="page-btn" @click="changeActivityPage(1)" :disabled="activityCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeActivityPage(activityCurrentPage - 1)" :disabled="activityCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ activityCurrentPage }} / {{ activityTotalPages }} 页</span>
                            <button class="page-btn" @click="changeActivityPage(activityCurrentPage + 1)" :disabled="activityCurrentPage === activityTotalPages">下一页</button>
                            <button class="page-btn" @click="changeActivityPage(activityTotalPages)" :disabled="activityCurrentPage === activityTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 账号管理页面 -->
                    <div v-if="activeMenu === 'accounts'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingAccounts || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <h1>账号管理</h1>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>账号</th>
                                    <th>密码</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="account in paginatedAccounts" :key="account.id">
                                    <td>{{ account.id }}</td>
                                    <td>{{ account.username }}</td>
                                    <td>{{ account.password }}</td>
                                    <td>{{ account.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('enable_account') && account.status === 1" class="enable-btn" @click="enableAccount(account.id)">启用</button>
                                        <button v-if="hasPermission('disable_account') && account.status === 0" class="disable-btn" @click="disableAccount(account.id)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 账号分页控件 -->
                        <div class="pagination" v-if="accountTotalPages > 1">
                            <button class="page-btn" @click="changeAccountPage(1)" :disabled="accountCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeAccountPage(accountCurrentPage - 1)" :disabled="accountCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ accountCurrentPage }} / {{ accountTotalPages }} 页</span>
                            <button class="page-btn" @click="changeAccountPage(accountCurrentPage + 1)" :disabled="accountCurrentPage === accountTotalPages">下一页</button>
                            <button class="page-btn" @click="changeAccountPage(accountTotalPages)" :disabled="accountCurrentPage === accountTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 合同管理页面 -->
                    <div v-if="activeMenu === 'contract_management'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingContracts || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>合同管理</h1>
                            <button v-if="hasPermission('add_contract')" class="add-btn" @click="openAddContractDrawer">新增合同</button>
                        </div>

                        <!-- 筛选区 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="contractIdFilter">ID</label>
                                    <input type="text" id="contractIdFilter" v-model="contractFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="contractUidFilter">UID</label>
                                    <input type="text" id="contractUidFilter" v-model="contractFilters.student_id" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="contractStudentNameFilter">学生姓名</label>
                                    <input type="text" id="contractStudentNameFilter" v-model="contractFilters.student_name" placeholder="请输入学生姓名">
                                </div>
                                <div class="filter-item">
                                    <label for="contractTypeFilter">合同类型</label>
                                    <select id="contractTypeFilter" v-model="contractFilters.type">
                                        <option value="">全部</option>
                                        <option value="0">首报</option>
                                        <option value="1">续报</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="contractStatusFilter">合同状态</label>
                                    <select id="contractStatusFilter" v-model="contractFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">待审核</option>
                                        <option value="50">已通过</option>
                                        <option value="98">已作废</option>
                                        <option value="99">协议中止</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="contractPaymentStatusFilter">付款状态</label>
                                    <select id="contractPaymentStatusFilter" v-model="contractFilters.payment_status">
                                        <option value="">全部</option>
                                        <option value="0">未付款</option>
                                        <option value="10">部分付款</option>
                                        <option value="30">已付款</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchContracts">搜索</button>
                                <button class="reset-btn" @click="resetContractFilters">重置</button>
                            </div>
                        </div>

                        <!-- 列表区 -->
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>学生姓名</th>
                                    <th>合同类型</th>
                                    <th>签署形式</th>
                                    <th>合同名称</th>
                                    <th>合同金额</th>
                                    <th>发起方</th>
                                    <th>签署方</th>
                                    <th>发起人</th>
                                    <th>合同状态</th>
                                    <th>付款状态</th>
                                    <th>创建时间</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="contract in paginatedContracts" :key="contract.id">
                                    <td>{{ contract.id }}</td>
                                    <td>{{ contract.student_id }}</td>
                                    <td>{{ contract.student_name }}</td>
                                    <td>{{ getContractTypeText(contract.type) }}</td>
                                    <td>{{ getSignatureFormText(contract.signature_form) }}</td>
                                    <td>{{ contract.name }}</td>
                                    <td>{{ contract.contract_amount }}</td>
                                    <td>{{ contract.initiating_party || '-' }}</td>
                                    <td>{{ contract.signatory }}</td>
                                    <td>{{ contract.initiator }}</td>
                                    <td>{{ getContractStatusText(contract.status) }}</td>
                                    <td>{{ getPaymentStatusText(contract.payment_status) }}</td>
                                    <td>{{ formatDateTime(contract.create_time) }}</td>
                                    <td class="action-column">
                                        <button
                                            class="edit-btn"
                                            @click="openContractDetailDrawer(contract)"
                                            :disabled="contract.signature_form == 0">
                                            详情
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 合同分页控件 -->
                        <div class="pagination" v-if="contractTotalPages > 1">
                            <button class="page-btn" @click="changeContractPage(1)" :disabled="contractCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeContractPage(contractCurrentPage - 1)" :disabled="contractCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ contractCurrentPage }} / {{ contractTotalPages }} 页</span>
                            <button class="page-btn" @click="changeContractPage(contractCurrentPage + 1)" :disabled="contractCurrentPage === contractTotalPages">下一页</button>
                            <button class="page-btn" @click="changeContractPage(contractTotalPages)" :disabled="contractCurrentPage === contractTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 收款管理页面 -->
                    <div v-if="activeMenu === 'payment_collection'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingPaymentCollections || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>收款管理</h1>
                            <button v-if="hasPermission('add_payment')" class="add-btn" @click="paymentCollectionTab === 'taobao' ? openAddTaobaoPaymentModal() : openAddPaymentCollectionModal()">新增收款</button>
                        </div>

                        <!-- 一级Tab -->
                        <div class="tab-container">
                            <div class="tab-nav">
                                <button
                                    class="tab-btn"
                                    :class="{ active: paymentCollectionTab === 'regular' }"
                                    @click="paymentCollectionTab = 'regular'">
                                    常规收款
                                </button>
                                <button
                                    class="tab-btn"
                                    :class="{ active: paymentCollectionTab === 'taobao' }"
                                    @click="paymentCollectionTab = 'taobao'; taobaoSubTab = 'paid'; fetchTaobaoPayments()">
                                    淘宝收款
                                </button>
                            </div>

                            <!-- 常规收款内容 -->
                            <div v-if="paymentCollectionTab === 'regular'" class="tab-content">
                                <!-- 二级Tab -->
                                <div class="sub-tab-nav">
                                    <button
                                        class="sub-tab-btn"
                                        :class="{ active: paymentCollectionSubTab === 'received' }"
                                        @click="paymentCollectionSubTab = 'received'; fetchPaymentCollections()">
                                        已收款
                                    </button>
                                    <button
                                        class="sub-tab-btn"
                                        :class="{ active: paymentCollectionSubTab === 'pending' }"
                                        @click="paymentCollectionSubTab = 'pending'; fetchUnclaimedPayments()">
                                        待认领
                                    </button>
                                </div>

                                <!-- 已收款内容 -->
                                <div v-if="paymentCollectionSubTab === 'received'">
                                    <!-- 筛选区 -->
                                    <div class="filter-form">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="pcIdFilter">ID</label>
                                                <input type="text" id="pcIdFilter" v-model="paymentCollectionFilters.id" placeholder="请输入ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcUidFilter">UID</label>
                                                <input type="text" id="pcUidFilter" v-model="paymentCollectionFilters.student_id" placeholder="请输入UID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcOrderIdFilter">订单ID</label>
                                                <input type="text" id="pcOrderIdFilter" v-model="paymentCollectionFilters.order_id" placeholder="请输入订单ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcPayerFilter">付款人</label>
                                                <input type="text" id="pcPayerFilter" v-model="paymentCollectionFilters.payer" placeholder="请输入付款人">
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcMethodFilter">付款方式</label>
                                                <select id="pcMethodFilter" v-model="paymentCollectionFilters.payment_method">
                                                    <option value="">全部</option>
                                                    <option value="0">微信</option>
                                                    <option value="1">支付宝</option>
                                                    <option value="2">优利支付</option>
                                                    <option value="3">零零购支付</option>
                                                    <option value="9">对公转账</option>
                                                </select>
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcDateFilter">付款时间</label>
                                                <input type="date" id="pcDateFilter" v-model="paymentCollectionFilters.trading_date">
                                            </div>
                                            <div class="filter-item">
                                                <label for="pcStatusFilter">状态</label>
                                                <select id="pcStatusFilter" v-model="paymentCollectionFilters.status">
                                                    <option value="">全部</option>
                                                    <option value="0">待支付</option>
                                                    <option value="10">未核验</option>
                                                    <option value="20">已支付</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="filter-actions">
                                            <button class="search-btn" @click="searchPaymentCollections">搜索</button>
                                            <button class="reset-btn" @click="resetPaymentCollectionFilters">重置</button>
                                        </div>
                                    </div>

                                    <!-- 列表区 -->
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>UID</th>
                                                <th>订单ID</th>
                                                <th>付款场景</th>
                                                <th>付款方式</th>
                                                <th>付款金额</th>
                                                <th>付款方</th>
                                                <th>收款主体</th>
                                                <th>商户订单号</th>
                                                <th>交易时间</th>
                                                <th>到账时间</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="pc in paginatedPaymentCollections" :key="pc.id">
                                                <td>{{ pc.id }}</td>
                                                <td>{{ pc.student_id || '-' }}</td>
                                                <td>{{ pc.order_id || '-' }}</td>
                                                <td>{{ getPaymentScenarioText(pc.payment_scenario) }}</td>
                                                <td>{{ getPaymentMethodText(pc.payment_method) }}</td>
                                                <td>{{ pc.payment_amount }}</td>
                                                <td>{{ pc.payer || '-' }}</td>
                                                <td>{{ getPayeeEntityText(pc.payee_entity) }}</td>
                                                <td>{{ pc.merchant_order || '-' }}</td>
                                                <td>{{ formatDateTime(pc.trading_hours) }}</td>
                                                <td>{{ pc.arrival_time ? formatDateTime(pc.arrival_time) : '-' }}</td>
                                                <td>{{ getCollectionStatusText(pc.status) }}</td>
                                                <td class="action-column">
                                                    <button
                                                        v-if="hasPermission('confirm_payment') && pc.status === 10"
                                                        class="edit-btn"
                                                        @click="confirmPaymentCollection(pc)">
                                                        确认到账
                                                    </button>
                                                    <button
                                                        v-if="hasPermission('delete_normal_payment') && pc.status === 10"
                                                        class="delete-btn"
                                                        @click="confirmDeletePaymentCollection(pc)">
                                                        删除
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- 分页控件 -->
                                    <div class="pagination" v-if="paymentCollectionTotalPages > 1">
                                        <button class="page-btn" @click="changePaymentCollectionPage(1)" :disabled="paymentCollectionCurrentPage === 1">首页</button>
                                        <button class="page-btn" @click="changePaymentCollectionPage(paymentCollectionCurrentPage - 1)" :disabled="paymentCollectionCurrentPage === 1">上一页</button>
                                        <span class="page-info">第 {{ paymentCollectionCurrentPage }} / {{ paymentCollectionTotalPages }} 页</span>
                                        <button class="page-btn" @click="changePaymentCollectionPage(paymentCollectionCurrentPage + 1)" :disabled="paymentCollectionCurrentPage === paymentCollectionTotalPages">下一页</button>
                                        <button class="page-btn" @click="changePaymentCollectionPage(paymentCollectionTotalPages)" :disabled="paymentCollectionCurrentPage === paymentCollectionTotalPages">末页</button>
                                    </div>
                                </div>

                                <!-- 待认领内容 -->
                                <div v-if="paymentCollectionSubTab === 'pending'" style="position: relative;">
                                    <!-- Loading遮罩层 -->
                                    <div v-if="loadingUnclaimedPayments" class="loading-overlay">
                                        <div class="loading-spinner"></div>
                                        <div class="loading-text">加载中...</div>
                                    </div>

                                    <!-- 操作按钮区 -->
                                    <div class="page-header" style="margin-bottom: 20px;">
                                        <div>
                                            <button class="add-btn" @click="downloadUnclaimedTemplate">模板下载</button>
                                            <label for="unclaimedImport" class="add-btn" style="margin-left: 10px;">
                                                模板导入
                                                <input type="file" id="unclaimedImport" @change="importUnclaimedExcel" accept=".xls,.xlsx" style="display: none;">
                                            </label>
                                        </div>
                                    </div>

                                    <!-- 筛选表单 -->
                                    <div class="filter-form">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="unclaimedIdFilter">ID</label>
                                                <input type="number" id="unclaimedIdFilter" v-model="unclaimedFilters.id" placeholder="请输入ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="unclaimedPayerFilter">付款方</label>
                                                <input type="text" id="unclaimedPayerFilter" v-model="unclaimedFilters.payer" placeholder="请输入付款方">
                                            </div>
                                            <div class="filter-item">
                                                <label for="unclaimedMethodFilter">付款方式</label>
                                                <select id="unclaimedMethodFilter" v-model="unclaimedFilters.payment_method">
                                                    <option value="">全部</option>
                                                    <option value="0">微信</option>
                                                    <option value="1">支付宝</option>
                                                    <option value="2">优利支付</option>
                                                    <option value="3">零零购支付</option>
                                                    <option value="9">对公转账</option>
                                                </select>
                                            </div>
                                            <div class="filter-item">
                                                <label for="unclaimedDateFilter">到账时间</label>
                                                <input type="date" id="unclaimedDateFilter" v-model="unclaimedFilters.arrival_date">
                                            </div>
                                            <div class="filter-item">
                                                <label for="unclaimedClaimerFilter">认领人</label>
                                                <input type="text" id="unclaimedClaimerFilter" v-model="unclaimedFilters.claimer" placeholder="请输入认领人">
                                            </div>
                                            <div class="filter-item">
                                                <label for="unclaimedStatusFilter">状态</label>
                                                <select id="unclaimedStatusFilter" v-model="unclaimedFilters.status">
                                                    <option value="">全部</option>
                                                    <option value="0">待认领</option>
                                                    <option value="1">已认领</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="filter-actions">
                                            <button class="search-btn" @click="fetchUnclaimedPayments">搜索</button>
                                            <button class="reset-btn" @click="unclaimedFilters = {id: '', payer: '', payment_method: '', arrival_date: '', claimer: '', status: ''}; fetchUnclaimedPayments()">重置</button>
                                        </div>
                                    </div>

                                    <!-- 待认领列表 -->
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>付款方式</th>
                                                <th>付款金额</th>
                                                <th>付款方</th>
                                                <th>收款主体</th>
                                                <th>商户订单号</th>
                                                <th>到账时间</th>
                                                <th>认领人</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="unclaimed in paginatedUnclaimedPayments" :key="unclaimed.id">
                                                <td>{{ unclaimed.id }}</td>
                                                <td>{{ getUnclaimedPaymentMethodText(unclaimed.payment_method) }}</td>
                                                <td>{{ unclaimed.payment_amount }}</td>
                                                <td>{{ unclaimed.payer }}</td>
                                                <td>{{ unclaimed.payee_entity === 0 ? '北京' : '西安' }}</td>
                                                <td>{{ unclaimed.merchant_order || '-' }}</td>
                                                <td>{{ unclaimed.arrival_time ? new Date(unclaimed.arrival_time).toLocaleDateString() : '' }}</td>
                                                <td>{{ unclaimed.claimer_name || '-' }}</td>
                                                <td>{{ getUnclaimedStatusText(unclaimed.status) }}</td>
                                                <td class="action-column">
                                                    <button v-if="hasPermission('claim_normal_payment') && unclaimed.status === 0" class="edit-btn" @click="confirmClaimUnclaimed(unclaimed)">认领</button>
                                                    <button v-if="hasPermission('delete_normal_claim') && unclaimed.status === 0" class="delete-btn" @click="confirmDeleteUnclaimed(unclaimed)">删除</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- 分页控件 -->
                                    <div class="pagination" v-if="totalUnclaimedPages > 1">
                                        <button class="page-btn" @click="unclaimedCurrentPage = 1" :disabled="unclaimedCurrentPage === 1">首页</button>
                                        <button class="page-btn" @click="unclaimedCurrentPage--" :disabled="unclaimedCurrentPage === 1">上一页</button>
                                        <span class="page-info">第 {{ unclaimedCurrentPage }} 页 / 共 {{ totalUnclaimedPages }} 页</span>
                                        <button class="page-btn" @click="unclaimedCurrentPage++" :disabled="unclaimedCurrentPage === totalUnclaimedPages">下一页</button>
                                        <button class="page-btn" @click="unclaimedCurrentPage = totalUnclaimedPages" :disabled="unclaimedCurrentPage === totalUnclaimedPages">末页</button>
                                    </div>
                                </div>
                            </div>

                            <!-- 淘宝收款内容 -->
                            <div v-if="paymentCollectionTab === 'taobao'" class="tab-content" style="position: relative;">
                                <!-- 子标签页 -->
                                <div class="sub-tab-nav">
                                    <button
                                        :class="['sub-tab-btn', { active: taobaoSubTab === 'paid' }]"
                                        @click="taobaoSubTab = 'paid'; fetchTaobaoPayments()">
                                        已付款
                                    </button>
                                    <button
                                        :class="['sub-tab-btn', { active: taobaoSubTab === 'unclaimed' }]"
                                        @click="taobaoSubTab = 'unclaimed'; fetchTaobaoUnclaimed()">
                                        待认领
                                    </button>
                                </div>

                                <!-- 已付款内容 -->
                                <div v-if="taobaoSubTab === 'paid'" style="position: relative;">
                                    <!-- Loading 遮罩 -->
                                    <div v-if="loadingTaobaoPayments" class="loading-overlay">
                                        <div class="loading-spinner"></div>
                                        <div class="loading-text">加载中...</div>
                                    </div>

                                    <!-- 筛选条件 -->
                                    <div class="filter-section">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="taobaoIdFilter">ID</label>
                                                <input type="text" id="taobaoIdFilter" v-model="taobaoPaymentFilters.id" placeholder="请输入ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoStudentIdFilter">UID</label>
                                                <input type="text" id="taobaoStudentIdFilter" v-model="taobaoPaymentFilters.student_id" placeholder="请输入UID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoOrderIdFilter">订单ID</label>
                                                <input type="text" id="taobaoOrderIdFilter" v-model="taobaoPaymentFilters.order_id" placeholder="请输入订单ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoOrderTimeFilter">下单时间</label>
                                                <input type="date" id="taobaoOrderTimeFilter" v-model="taobaoPaymentFilters.order_time">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoStatusFilter">状态</label>
                                                <select id="taobaoStatusFilter" v-model="taobaoPaymentFilters.status">
                                                    <option value="">全部</option>
                                                    <option value="0">已下单</option>
                                                    <option value="30">已到账</option>
                                                    <option value="40">已退单</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="filter-buttons">
                                            <button class="search-btn" @click="searchTaobaoPayments">搜索</button>
                                            <button class="reset-btn" @click="resetTaobaoPaymentFilters">重置</button>
                                        </div>
                                    </div>

                                    <!-- 数据表格 -->
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>UID</th>
                                                <th>订单ID</th>
                                                <th>付款方</th>
                                                <th>支付宝账号</th>
                                                <th>金额</th>
                                                <th>下单时间</th>
                                                <th>到账时间</th>
                                                <th>商户订单号</th>
                                                <th>状态</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="tp in paginatedTaobaoPayments" :key="tp.id">
                                                <td>{{ tp.id }}</td>
                                                <td>{{ tp.student_id || '-' }}</td>
                                                <td>{{ tp.order_id || '-' }}</td>
                                                <td>{{ tp.payer || '-' }}</td>
                                                <td>{{ tp.zhifubao_account || '-' }}</td>
                                                <td>{{ tp.payment_amount }}</td>
                                                <td>{{ tp.order_time ? tp.order_time.replace('T', ' ').substring(0, 19) : '-' }}</td>
                                                <td>{{ tp.arrival_time ? tp.arrival_time.replace('T', ' ').substring(0, 19) : '-' }}</td>
                                                <td>{{ tp.merchant_order || '-' }}</td>
                                                <td>{{ getTaobaoStatusText(tp.status) }}</td>
                                                <td>
                                                    <button v-if="hasPermission('confirm_payment') && tp.status === 0" class="action-btn confirm-btn" @click="confirmTaobaoPayment(tp)">确认到账</button>
                                                    <button v-if="hasPermission('delete_taobao_payment') && tp.status !== 30" class="action-btn delete-btn" @click="deleteTaobaoPayment(tp)">删除</button>
                                                </td>
                                            </tr>
                                            <tr v-if="paginatedTaobaoPayments.length === 0">
                                                <td colspan="11" style="text-align: center; padding: 20px;">暂无数据</td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- 分页 -->
                                    <div class="pagination" v-if="totalTaobaoPaymentPages > 1">
                                        <button @click="changeTaobaoPaymentPage(taobaoPaymentCurrentPage - 1)" :disabled="taobaoPaymentCurrentPage === 1">上一页</button>
                                        <span>第 {{ taobaoPaymentCurrentPage }} / {{ totalTaobaoPaymentPages }} 页</span>
                                        <button @click="changeTaobaoPaymentPage(taobaoPaymentCurrentPage + 1)" :disabled="taobaoPaymentCurrentPage === totalTaobaoPaymentPages">下一页</button>
                                    </div>
                                </div>

                                <!-- 待认领内容 -->
                                <div v-if="taobaoSubTab === 'unclaimed'" style="position: relative;">
                                    <!-- Loading 遮罩 -->
                                    <div v-if="loadingTaobaoUnclaimed" class="loading-overlay">
                                        <div class="loading-spinner"></div>
                                        <div class="loading-text">加载中...</div>
                                    </div>

                                    <!-- 操作按钮区 -->
                                    <div class="page-header" style="margin-bottom: 20px;">
                                        <div>
                                            <button class="add-btn" @click="downloadTaobaoTemplate">模板下载</button>
                                            <label for="taobaoTemplateImport" class="add-btn" style="margin-left: 10px;">
                                                模板导入
                                                <input type="file" id="taobaoTemplateImport" @change="importTaobaoExcel" accept=".xlsx,.xls" style="display: none;">
                                            </label>
                                        </div>
                                    </div>

                                    <!-- 筛选条件 -->
                                    <div class="filter-section">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="taobaoUnclaimedIdFilter">ID</label>
                                                <input type="text" id="taobaoUnclaimedIdFilter" v-model="taobaoUnclaimedFilters.id" placeholder="请输入ID">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoArrivalTimeFilter">到账时间</label>
                                                <input type="date" id="taobaoArrivalTimeFilter" v-model="taobaoUnclaimedFilters.arrival_time">
                                            </div>
                                            <div class="filter-item">
                                                <label for="taobaoUnclaimedStatusFilter">状态</label>
                                                <select id="taobaoUnclaimedStatusFilter" v-model="taobaoUnclaimedFilters.status">
                                                    <option value="">全部</option>
                                                    <option value="10">待认领</option>
                                                    <option value="20">已认领</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="filter-buttons">
                                            <button class="search-btn" @click="searchTaobaoUnclaimed">搜索</button>
                                            <button class="reset-btn" @click="resetTaobaoUnclaimedFilters">重置</button>
                                        </div>
                                    </div>

                                    <!-- 数据表格 -->
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>付款方</th>
                                                <th>支付宝账号</th>
                                                <th>金额</th>
                                                <th>到账时间</th>
                                                <th>商户订单号</th>
                                                <th>状态</th>
                                                <th>认领人ID</th>
                                                <th>操作</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr v-for="tu in paginatedTaobaoUnclaimed" :key="tu.id">
                                                <td>{{ tu.id }}</td>
                                                <td>{{ tu.payer || '-' }}</td>
                                                <td>{{ tu.zhifubao_account || '-' }}</td>
                                                <td>{{ tu.payment_amount }}</td>
                                                <td>{{ tu.arrival_time ? tu.arrival_time.replace('T', ' ').substring(0, 19) : '-' }}</td>
                                                <td>{{ tu.merchant_order || '-' }}</td>
                                                <td>{{ getTaobaoUnclaimedStatusText(tu.status) }}</td>
                                                <td>{{ tu.claimer || '-' }}</td>
                                                <td class="action-column">
                                                    <button v-if="hasPermission('claim_taobao_payment') && tu.status === 10" class="edit-btn" @click="claimTaobaoUnclaimed(tu)">认领</button>
                                                    <button v-if="hasPermission('delete_taobao_claim') && tu.status === 10" class="delete-btn" @click="deleteTaobaoUnclaimed(tu)">删除</button>
                                                </td>
                                            </tr>
                                            <tr v-if="paginatedTaobaoUnclaimed.length === 0">
                                                <td colspan="9" style="text-align: center; padding: 20px;">暂无数据</td>
                                            </tr>
                                        </tbody>
                                    </table>

                                    <!-- 分页 -->
                                    <div class="pagination" v-if="totalTaobaoUnclaimedPages > 1">
                                        <button @click="changeTaobaoUnclaimedPage(taobaoUnclaimedCurrentPage - 1)" :disabled="taobaoUnclaimedCurrentPage === 1">上一页</button>
                                        <span>第 {{ taobaoUnclaimedCurrentPage }} / {{ totalTaobaoUnclaimedPages }} 页</span>
                                        <button @click="changeTaobaoUnclaimedPage(taobaoUnclaimedCurrentPage + 1)" :disabled="taobaoUnclaimedCurrentPage === totalTaobaoUnclaimedPages">下一页</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 分账明细页面 -->
                    <div v-if="activeMenu === 'separate_account'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingSeparateAccounts" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>分账明细</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="separateAccountIdFilter">ID</label>
                                    <input type="number" id="separateAccountIdFilter" v-model="separateAccountFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountUidFilter">UID</label>
                                    <input type="number" id="separateAccountUidFilter" v-model="separateAccountFilters.uid" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountOrdersIdFilter">订单ID</label>
                                    <input type="number" id="separateAccountOrdersIdFilter" v-model="separateAccountFilters.orders_id" placeholder="请输入订单ID">
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountChildordersIdFilter">子订单ID</label>
                                    <input type="number" id="separateAccountChildordersIdFilter" v-model="separateAccountFilters.childorders_id" placeholder="请输入子订单ID">
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountGoodsIdFilter">商品ID</label>
                                    <input type="number" id="separateAccountGoodsIdFilter" v-model="separateAccountFilters.goods_id" placeholder="请输入商品ID">
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountPaymentTypeFilter">收款类型</label>
                                    <select id="separateAccountPaymentTypeFilter" v-model="separateAccountFilters.payment_type">
                                        <option value="">全部</option>
                                        <option value="0">常规收款</option>
                                        <option value="1">淘宝收款</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="separateAccountTypeFilter">类型</label>
                                    <select id="separateAccountTypeFilter" v-model="separateAccountFilters.type">
                                        <option value="">全部</option>
                                        <option value="0">售卖</option>
                                        <option value="1">冲回</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchSeparateAccounts">搜索</button>
                                <button class="reset-btn" @click="resetSeparateAccountFilters">重置</button>
                            </div>
                        </div>

                        <!-- 数据表格 -->
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>订单ID</th>
                                    <th>子订单ID</th>
                                    <th>收款ID</th>
                                    <th>收款类型</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>分账金额</th>
                                    <th>类型</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="sa in paginatedSeparateAccounts" :key="sa.id">
                                    <td>{{ sa.id }}</td>
                                    <td>{{ sa.uid }}</td>
                                    <td>{{ sa.orders_id }}</td>
                                    <td>{{ sa.childorders_id }}</td>
                                    <td>{{ sa.payment_id }}</td>
                                    <td>{{ getPaymentTypeText(sa.payment_type) }}</td>
                                    <td>{{ sa.goods_id }}</td>
                                    <td>{{ sa.goods_name }}</td>
                                    <td>{{ sa.separate_amount }}</td>
                                    <td>{{ getSeparateAccountTypeText(sa.type) }}</td>
                                </tr>
                                <tr v-if="paginatedSeparateAccounts.length === 0">
                                    <td colspan="10" style="text-align: center; padding: 20px;">暂无数据</td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 分页控件 -->
                        <div class="pagination" v-if="totalSeparateAccountPages > 1">
                            <button @click="changeSeparateAccountPage(separateAccountCurrentPage - 1)" :disabled="separateAccountCurrentPage === 1">上一页</button>
                            <span>第 {{ separateAccountCurrentPage }} / {{ totalSeparateAccountPages }} 页</span>
                            <button @click="changeSeparateAccountPage(separateAccountCurrentPage + 1)" :disabled="separateAccountCurrentPage === totalSeparateAccountPages">下一页</button>
                        </div>
                    </div>

                    <!-- 退费管理页面 -->
                    <div v-if="activeMenu === 'refund_management'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingRegularRefunds || loadingTaobaoRefunds" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>退费管理</h1>
                        </div>

                        <!-- Tab导航 -->
                        <div class="tab-container">
                            <div class="tab-navigation">
                                <button class="tab-btn" :class="{active: refundManagementTab === 'regular'}" @click="refundManagementTab = 'regular'; fetchRegularRefunds()">常规退费</button>
                                <button class="tab-btn" :class="{active: refundManagementTab === 'taobao'}" @click="refundManagementTab = 'taobao'; fetchTaobaoRefunds()">淘宝退费</button>
                            </div>

                            <!-- 常规退费 Tab -->
                            <div v-if="refundManagementTab === 'regular'" class="tab-content">
                                <!-- 筛选表单 -->
                                <div class="filter-form">
                                    <div class="filter-row">
                                        <div class="filter-item">
                                            <label for="regularRefundIdFilter">ID</label>
                                            <input type="number" id="regularRefundIdFilter" v-model="regularRefundFilters.id" placeholder="请输入ID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="regularRefundUidFilter">UID</label>
                                            <input type="number" id="regularRefundUidFilter" v-model="regularRefundFilters.student_id" placeholder="请输入UID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="regularRefundOrderIdFilter">退费ID</label>
                                            <input type="number" id="regularRefundOrderIdFilter" v-model="regularRefundFilters.refund_order_id" placeholder="请输入退费ID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="regularRefundPayerFilter">付款方</label>
                                            <input type="text" id="regularRefundPayerFilter" v-model="regularRefundFilters.payer" placeholder="请输入付款方">
                                        </div>
                                        <div class="filter-item">
                                            <label for="regularRefundStatusFilter">状态</label>
                                            <select id="regularRefundStatusFilter" v-model="regularRefundFilters.status">
                                                <option value="">全部</option>
                                                <option value="0">退费中</option>
                                                <option value="10">已通过</option>
                                                <option value="20">已驳回</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="filter-actions">
                                        <button class="search-btn" @click="searchRegularRefunds">搜索</button>
                                        <button class="reset-btn" @click="resetRegularRefundFilters">重置</button>
                                    </div>
                                </div>

                                <!-- 数据表格 -->
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>UID</th>
                                            <th>退费ID</th>
                                            <th>付款方</th>
                                            <th>银行账户</th>
                                            <th>退费金额</th>
                                            <th>状态</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="item in paginatedRegularRefunds" :key="item.id">
                                            <td>{{ item.id }}</td>
                                            <td>{{ item.uid }}</td>
                                            <td>{{ item.refund_order_id }}</td>
                                            <td>{{ item.payer || '-' }}</td>
                                            <td>{{ item.bank_account || '-' }}</td>
                                            <td style="font-weight: bold; color: #e74c3c;">{{ item.refund_amount }}</td>
                                            <td>{{ getRefundOrderStatusText(item.status) }}</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- 分页控件 -->
                                <div class="pagination" v-if="regularRefundTotalPages > 1">
                                    <button class="page-btn" @click="changeRegularRefundPage(1)" :disabled="regularRefundCurrentPage === 1">首页</button>
                                    <button class="page-btn" @click="changeRegularRefundPage(regularRefundCurrentPage - 1)" :disabled="regularRefundCurrentPage === 1">上一页</button>
                                    <span class="page-info">第 {{ regularRefundCurrentPage }} / {{ regularRefundTotalPages }} 页</span>
                                    <button class="page-btn" @click="changeRegularRefundPage(regularRefundCurrentPage + 1)" :disabled="regularRefundCurrentPage === regularRefundTotalPages">下一页</button>
                                    <button class="page-btn" @click="changeRegularRefundPage(regularRefundTotalPages)" :disabled="regularRefundCurrentPage === regularRefundTotalPages">末页</button>
                                </div>
                            </div>

                            <!-- 淘宝退费 Tab -->
                            <div v-if="refundManagementTab === 'taobao'" class="tab-content">
                                <!-- 筛选表单 -->
                                <div class="filter-form">
                                    <div class="filter-row">
                                        <div class="filter-item">
                                            <label for="taobaoRefundIdFilter">ID</label>
                                            <input type="number" id="taobaoRefundIdFilter" v-model="taobaoRefundFilters.id" placeholder="请输入ID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="taobaoRefundUidFilter">UID</label>
                                            <input type="number" id="taobaoRefundUidFilter" v-model="taobaoRefundFilters.student_id" placeholder="请输入UID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="taobaoRefundOrderIdFilter">退费ID</label>
                                            <input type="number" id="taobaoRefundOrderIdFilter" v-model="taobaoRefundFilters.refund_order_id" placeholder="请输入退费ID">
                                        </div>
                                        <div class="filter-item">
                                            <label for="taobaoRefundStatusFilter">状态</label>
                                            <select id="taobaoRefundStatusFilter" v-model="taobaoRefundFilters.status">
                                                <option value="">全部</option>
                                                <option value="0">退费中</option>
                                                <option value="10">已通过</option>
                                                <option value="20">已驳回</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="filter-actions">
                                        <button class="search-btn" @click="searchTaobaoRefunds">搜索</button>
                                        <button class="reset-btn" @click="resetTaobaoRefundFilters">重置</button>
                                    </div>
                                </div>

                                <!-- 数据表格 -->
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>UID</th>
                                            <th>退费ID</th>
                                            <th>支付宝账号</th>
                                            <th>支付宝名称</th>
                                            <th>退费金额</th>
                                            <th>状态</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="item in paginatedTaobaoRefunds" :key="item.id">
                                            <td>{{ item.id }}</td>
                                            <td>{{ item.uid }}</td>
                                            <td>{{ item.refund_order_id }}</td>
                                            <td>{{ item.alipay_account }}</td>
                                            <td>{{ item.alipay_name }}</td>
                                            <td style="font-weight: bold; color: #e74c3c;">{{ item.refund_amount }}</td>
                                            <td>{{ getRefundOrderStatusText(item.status) }}</td>
                                        </tr>
                                    </tbody>
                                </table>

                                <!-- 分页控件 -->
                                <div class="pagination" v-if="taobaoRefundTotalPages > 1">
                                    <button class="page-btn" @click="changeTaobaoRefundPage(1)" :disabled="taobaoRefundCurrentPage === 1">首页</button>
                                    <button class="page-btn" @click="changeTaobaoRefundPage(taobaoRefundCurrentPage - 1)" :disabled="taobaoRefundCurrentPage === 1">上一页</button>
                                    <span class="page-info">第 {{ taobaoRefundCurrentPage }} / {{ taobaoRefundTotalPages }} 页</span>
                                    <button class="page-btn" @click="changeTaobaoRefundPage(taobaoRefundCurrentPage + 1)" :disabled="taobaoRefundCurrentPage === taobaoRefundTotalPages">下一页</button>
                                    <button class="page-btn" @click="changeTaobaoRefundPage(taobaoRefundTotalPages)" :disabled="taobaoRefundCurrentPage === taobaoRefundTotalPages">末页</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 退费明细页面 -->
                    <div v-if="activeMenu === 'refund_payment_detail'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingRefundPaymentDetails" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>退费明细</h1>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="refundPaymentDetailIdFilter">ID</label>
                                    <input type="number" id="refundPaymentDetailIdFilter" v-model="refundPaymentDetailFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailUidFilter">UID</label>
                                    <input type="number" id="refundPaymentDetailUidFilter" v-model="refundPaymentDetailFilters.student_id" placeholder="请输入UID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailOrderIdFilter">订单ID</label>
                                    <input type="number" id="refundPaymentDetailOrderIdFilter" v-model="refundPaymentDetailFilters.order_id" placeholder="请输入订单ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailRefundOrderIdFilter">退款ID</label>
                                    <input type="number" id="refundPaymentDetailRefundOrderIdFilter" v-model="refundPaymentDetailFilters.refund_order_id" placeholder="请输入退款ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailPaymentIdFilter">收款ID</label>
                                    <input type="number" id="refundPaymentDetailPaymentIdFilter" v-model="refundPaymentDetailFilters.payment_id" placeholder="请输入收款ID">
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailPaymentTypeFilter">收款类型</label>
                                    <select id="refundPaymentDetailPaymentTypeFilter" v-model="refundPaymentDetailFilters.payment_type">
                                        <option value="">全部</option>
                                        <option value="0">常规收款</option>
                                        <option value="1">淘宝收款</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="refundPaymentDetailStatusFilter">状态</label>
                                    <select id="refundPaymentDetailStatusFilter" v-model="refundPaymentDetailFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">退费中</option>
                                        <option value="10">已通过</option>
                                        <option value="20">已驳回</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchRefundPaymentDetails">搜索</button>
                                <button class="reset-btn" @click="resetRefundPaymentDetailFilters">重置</button>
                            </div>
                        </div>

                        <!-- 数据表格 -->
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>UID</th>
                                    <th>订单ID</th>
                                    <th>退款ID</th>
                                    <th>收款ID</th>
                                    <th>收款类型</th>
                                    <th>收款主体</th>
                                    <th>退费金额</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in paginatedRefundPaymentDetails" :key="item.id">
                                    <td>{{ item.id }}</td>
                                    <td>{{ item.uid }}</td>
                                    <td>{{ item.order_id }}</td>
                                    <td>{{ item.refund_order_id }}</td>
                                    <td>{{ item.payment_id }}</td>
                                    <td>{{ getPaymentTypeText(item.payment_type) }}</td>
                                    <td>{{ getPayeeEntityText(item.payee_entity) }}</td>
                                    <td style="font-weight: bold; color: #e74c3c;">{{ item.refund_amount }}</td>
                                    <td>{{ getRefundOrderStatusText(item.status) }}</td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 分页控件 -->
                        <div class="pagination" v-if="refundPaymentDetailTotalPages > 1">
                            <button class="page-btn" @click="changeRefundPaymentDetailPage(1)" :disabled="refundPaymentDetailCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeRefundPaymentDetailPage(refundPaymentDetailCurrentPage - 1)" :disabled="refundPaymentDetailCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ refundPaymentDetailCurrentPage }} / {{ refundPaymentDetailTotalPages }} 页</span>
                            <button class="page-btn" @click="changeRefundPaymentDetailPage(refundPaymentDetailCurrentPage + 1)" :disabled="refundPaymentDetailCurrentPage === refundPaymentDetailTotalPages">下一页</button>
                            <button class="page-btn" @click="changeRefundPaymentDetailPage(refundPaymentDetailTotalPages)" :disabled="refundPaymentDetailCurrentPage === refundPaymentDetailTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 属性管理页面 -->
                    <div v-if="activeMenu === 'attributes'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingAttributes || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>属性管理</h1>
                            <button v-if="hasPermission('add_attribute')" class="add-btn" @click="openAddAttributeModal">新增属性</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="attributeIdFilter">ID</label>
                                    <input type="number" id="attributeIdFilter" v-model="attributeFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="attributeClassifyFilter">分类</label>
                                    <select id="attributeClassifyFilter" v-model="attributeFilters.classify">
                                        <option value="">全部</option>
                                        <option value="0">属性</option>
                                        <option value="1">规格</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="attributeStatusFilter">状态</label>
                                    <select id="attributeStatusFilter" v-model="attributeFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchAttributes">搜索</button>
                                <button class="reset-btn" @click="resetAttributeFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>名字</th>
                                    <th>分类</th>
                                    <th>属性值</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="attribute in paginatedAttributes" :key="attribute.id">
                                    <td>{{ attribute.id }}</td>
                                    <td>{{ attribute.name }}</td>
                                    <td>{{ getClassifyText(attribute.classify) }}</td>
                                    <td>{{ attribute.value_count || 0 }}</td>
                                    <td>{{ getAttributeStatusText(attribute.status) }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_attribute')" class="edit-btn" @click="openEditAttributeModal(attribute)">编辑</button>
                                        <button v-if="hasPermission('edit_attribute_value')" class="edit-btn" @click="openAttributeValuesModal(attribute)">属性值</button>
                                        <button v-if="hasPermission('enable_attribute') && attribute.status === 1" class="enable-btn" @click="openEnableAttributeConfirm(attribute.id)">启用</button>
                                        <button v-if="hasPermission('disable_attribute') && attribute.status === 0" class="disable-btn" @click="openDisableAttributeConfirm(attribute.id)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 属性分页控件 -->
                        <div class="pagination" v-if="attributeTotalPages > 1">
                            <button class="page-btn" @click="changeAttributePage(1)" :disabled="attributeCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeAttributePage(attributeCurrentPage - 1)" :disabled="attributeCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ attributeCurrentPage }} / {{ attributeTotalPages }} 页</span>
                            <button class="page-btn" @click="changeAttributePage(attributeCurrentPage + 1)" :disabled="attributeCurrentPage === attributeTotalPages">下一页</button>
                            <button class="page-btn" @click="changeAttributePage(attributeTotalPages)" :disabled="attributeCurrentPage === attributeTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 类型管理页面 -->
                    <div v-if="activeMenu === 'classifies'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingClassifies || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>类型管理</h1>
                            <button v-if="hasPermission('add_classify')" class="add-btn" @click="openAddClassifyModal">新增</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="classifyIdFilter">ID</label>
                                    <input type="number" id="classifyIdFilter" v-model="classifyFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="classifyLevelFilter">级别</label>
                                    <select id="classifyLevelFilter" v-model="classifyFilters.level">
                                        <option value="">全部</option>
                                        <option value="0">一级</option>
                                        <option value="1">二级</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="classifyStatusFilter">状态</label>
                                    <select id="classifyStatusFilter" v-model="classifyFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchClassifies">搜索</button>
                                <button class="reset-btn" @click="resetClassifyFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>名称</th>
                                    <th>级别</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="classify in paginatedClassifies" :key="classify.id">
                                    <td>{{ classify.id }}</td>
                                    <td>{{ classify.name }}</td>
                                    <td>{{ getClassifyLevelText(classify.level) }}</td>
                                    <td>{{ getClassifyStatusText(classify.status) }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_classify')" class="edit-btn" @click="openEditClassifyModal(classify)">编辑</button>
                                        <button v-if="hasPermission('enable_classify') && classify.status === 1" class="enable-btn" @click="openEnableClassifyConfirm(classify.id)">启用</button>
                                        <button v-if="hasPermission('disable_classify') && classify.status === 0" class="disable-btn" @click="openDisableClassifyConfirm(classify.id)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 类型分页控件 -->
                        <div class="pagination" v-if="classifyTotalPages > 1">
                            <button class="page-btn" @click="changeClassifyPage(1)" :disabled="classifyCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeClassifyPage(classifyCurrentPage - 1)" :disabled="classifyCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ classifyCurrentPage }} / {{ classifyTotalPages }} 页</span>
                            <button class="page-btn" @click="changeClassifyPage(classifyCurrentPage + 1)" :disabled="classifyCurrentPage === classifyTotalPages">下一页</button>
                            <button class="page-btn" @click="changeClassifyPage(classifyTotalPages)" :disabled="classifyCurrentPage === classifyTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 品牌管理页面 -->
                    <div v-if="activeMenu === 'brands'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingBrands || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>品牌管理</h1>
                            <button v-if="hasPermission('add_brand')" class="add-btn" @click="openAddBrandModal">新增</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="brandIdFilter">ID</label>
                                    <input type="number" id="brandIdFilter" v-model="brandFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="brandNameFilter">名称</label>
                                    <input type="text" id="brandNameFilter" v-model="brandFilters.name" placeholder="请输入名称">
                                </div>
                                <div class="filter-item">
                                    <label for="brandStatusFilter">状态</label>
                                    <select id="brandStatusFilter" v-model="brandFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchBrands">搜索</button>
                                <button class="reset-btn" @click="resetBrandFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>名称</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="brand in paginatedBrands" :key="brand.id">
                                    <td>{{ brand.id }}</td>
                                    <td>{{ brand.name }}</td>
                                    <td>{{ getBrandStatusText(brand.status) }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_brand')" class="edit-btn" @click="openEditBrandModal(brand)">编辑</button>
                                        <button v-if="hasPermission('enable_brand') && brand.status === 1" class="enable-btn" @click="openEnableBrandConfirm(brand.id)">启用</button>
                                        <button v-if="hasPermission('disable_brand') && brand.status === 0" class="disable-btn" @click="openDisableBrandConfirm(brand.id)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 品牌分页控件 -->
                        <div class="pagination" v-if="brandTotalPages > 1">
                            <button class="page-btn" @click="changeBrandPage(1)" :disabled="brandCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeBrandPage(brandCurrentPage - 1)" :disabled="brandCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ brandCurrentPage }} / {{ brandTotalPages }} 页</span>
                            <button class="page-btn" @click="changeBrandPage(brandCurrentPage + 1)" :disabled="brandCurrentPage === brandTotalPages">下一页</button>
                            <button class="page-btn" @click="changeBrandPage(brandTotalPages)" :disabled="brandCurrentPage === brandTotalPages">末页</button>
                        </div>
                    </div>

                    <!-- 商品管理页面 -->
                    <div v-if="activeMenu === 'goods'" style="position: relative;">
                        <!-- Loading遮罩层 -->
                        <div v-if="loadingGoods || loadingPermissions" class="loading-overlay">
                            <div class="loading-spinner"></div>
                            <div class="loading-text">加载中...</div>
                        </div>

                        <div class="page-header">
                            <h1>商品管理</h1>
                            <button v-if="hasPermission('add_goods')" class="add-btn" @click="openAddGoodsDrawer">新增</button>
                        </div>

                        <!-- 筛选表单 -->
                        <div class="filter-form">
                            <div class="filter-row">
                                <div class="filter-item">
                                    <label for="goodsIdFilter">ID</label>
                                    <input type="number" id="goodsIdFilter" v-model="goodsFilters.id" placeholder="请输入ID">
                                </div>
                                <div class="filter-item">
                                    <label for="goodsNameFilter">名称</label>
                                    <input type="text" id="goodsNameFilter" v-model="goodsFilters.name" placeholder="请输入名称">
                                </div>
                                <div class="filter-item">
                                    <label for="goodsBrandFilter">品牌</label>
                                    <select id="goodsBrandFilter" v-model="goodsFilters.brandid">
                                        <option value="">全部</option>
                                        <option v-for="brand in brands" :key="brand.id" :value="brand.id">{{ brand.name }}</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="goodsClassifyFilter">类型</label>
                                    <select id="goodsClassifyFilter" v-model="goodsFilters.classifyid">
                                        <option value="">全部</option>
                                        <option v-for="classify in classifies" :key="classify.id" :value="classify.id">{{ classify.name }}</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <label for="goodsStatusFilter">状态</label>
                                    <select id="goodsStatusFilter" v-model="goodsFilters.status">
                                        <option value="">全部</option>
                                        <option value="0">启用</option>
                                        <option value="1">禁用</option>
                                    </select>
                                </div>
                            </div>
                            <div class="filter-actions">
                                <button class="search-btn" @click="searchGoods">搜索</button>
                                <button class="reset-btn" @click="resetGoodsFilters">重置</button>
                            </div>
                        </div>

                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>名称</th>
                                    <th>价格</th>
                                    <th>品牌</th>
                                    <th>类型</th>
                                    <th>属性</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in paginatedGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>{{ goods.brand_name }}</td>
                                    <td>{{ goods.classify_name }}</td>
                                    <td :title="getFullAttributes(goods)" class="goods-attributes-cell">
                                        {{ formatGoodsAttributes(goods) || '无' }}
                                    </td>
                                    <td>{{ goods.status === 0 ? '启用' : '禁用' }}</td>
                                    <td class="action-column">
                                        <button v-if="hasPermission('edit_goods')" class="edit-btn" @click="openEditGoodsDrawer(goods.id)">编辑</button>
                                        <button v-if="hasPermission('enable_goods') && goods.status === 1" class="enable-btn" @click="openEnableGoodsConfirm(goods.id)">启用</button>
                                        <button v-if="hasPermission('disable_goods') && goods.status === 0" class="disable-btn" @click="openDisableGoodsConfirm(goods.id)">禁用</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- 商品分页控件 -->
                        <div class="pagination" v-if="goodsTotalPages > 1">
                            <button class="page-btn" @click="changeGoodsPage(1)" :disabled="goodsCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeGoodsPage(goodsCurrentPage - 1)" :disabled="goodsCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ goodsCurrentPage }} / {{ goodsTotalPages }} 页</span>
                            <button class="page-btn" @click="changeGoodsPage(goodsCurrentPage + 1)" :disabled="goodsCurrentPage === goodsTotalPages">下一页</button>
                            <button class="page-btn" @click="changeGoodsPage(goodsTotalPages)" :disabled="goodsCurrentPage === goodsTotalPages">末页</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 启用权限确认弹窗 -->
        <div class="modal-overlay" v-if="showEnablePermissionConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认启用</h2>
                </div>
                <div class="modal-body">
                    <p>是否启用该权限？</p>
                    <p style="color: #27ae60; font-size: 14px;">启用后该权限绑定的按钮将展示于对应页面。</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showEnablePermissionConfirm = false">取消</button>
                    <button class="confirm-btn" @click="doEnablePermission">确认</button>
                </div>
            </div>
        </div>

        <!-- 禁用权限确认弹窗 -->
        <div class="modal-overlay" v-if="showDisablePermissionConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认禁用</h2>
                </div>
                <div class="modal-body">
                    <p>是否禁用该权限？</p>
                    <p style="color: #e74c3c; font-size: 14px;">禁用后该权限绑定的按钮将隐藏于对应页面。</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDisablePermissionConfirm = false">取消</button>
                    <button class="delete-btn" @click="doDisablePermission">确认</button>
                </div>
            </div>
        </div>

        <!-- 新增学生弹窗 -->
        <div class="modal-overlay" v-if="showAddStudentModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增学生</h3>
                    <button class="close-btn" @click="closeAddStudentModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="addStudentName">姓名 <span class="required">*</span></label>
                        <input type="text" id="addStudentName" v-model="addStudentData.name" placeholder="请输入姓名" required>
                    </div>
                    <div class="form-group">
                        <label for="addStudentSex">性别 <span class="required">*</span></label>
                        <select id="addStudentSex" v-model="addStudentData.sex_id" required>
                            <option value="">请选择性别</option>
                            <option v-for="sex in sexes" :key="sex.id" :value="sex.id">{{ sex.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addStudentPhone">电话 <span class="required">*</span></label>
                        <input type="text" id="addStudentPhone" v-model="addStudentData.phone" placeholder="请输入电话" required>
                    </div>
                    <div class="form-group">
                        <label for="addStudentGrade">年级 <span class="required">*</span></label>
                        <select id="addStudentGrade" v-model="addStudentData.grade_id" required>
                            <option value="">请选择年级</option>
                            <option v-for="grade in activeGrades" :key="grade.id" :value="grade.id">{{ grade.grade }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addStudentCoaches">教练</label>
                        <div class="multi-select">
                            <div v-for="coach in activeCoaches" :key="coach.id" class="checkbox-item">
                                <input
                                    type="checkbox"
                                    :id="'coach-' + coach.id"
                                    :value="coach.id"
                                    v-model="addStudentData.coach_ids">
                                <label :for="'coach-' + coach.id">{{ coach.coach_name }}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddStudentModal">取消</button>
                    <button class="save-btn" @click="saveAddStudent">保存</button>
                </div>
            </div>
        </div>

        <!-- 学生编辑弹窗 -->
        <div class="modal-overlay" v-if="showEditStudentModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>编辑学生信息</h3>
                    <button class="close-btn" @click="closeEditStudentModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editStudentName">姓名</label>
                        <input type="text" id="editStudentName" v-model="editStudentData.name" placeholder="请输入姓名">
                    </div>
                    <div class="form-group">
                        <label for="editStudentSex">性别</label>
                        <select id="editStudentSex" v-model="editStudentData.sex_id">
                            <option v-for="sex in sexes" :key="sex.id" :value="sex.id">{{ sex.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editStudentPhone">手机号</label>
                        <input type="text" id="editStudentPhone" v-model="editStudentData.phone" placeholder="请输入手机号">
                    </div>
                    <div class="form-group">
                        <label for="editStudentGrade">年级</label>
                        <select id="editStudentGrade" v-model="editStudentData.grade_id">
                            <option v-for="grade in activeGrades" :key="grade.id" :value="grade.id">{{ grade.grade }}</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditStudentModal">取消</button>
                    <button class="save-btn" @click="saveEditStudent">保存</button>
                </div>
            </div>
        </div>
        
        <!-- 教练编辑弹窗 -->
        <div class="modal-overlay" v-if="showEditCoachModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>编辑教练信息</h3>
                    <button class="close-btn" @click="closeEditCoachModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editCoachName">姓名</label>
                        <input type="text" id="editCoachName" v-model="editCoachData.name" placeholder="请输入姓名">
                    </div>
                    <div class="form-group">
                        <label for="editCoachSex">性别</label>
                        <select id="editCoachSex" v-model="editCoachData.sex_id">
                            <option v-for="sex in sexes" :key="sex.id" :value="sex.id">{{ sex.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editCoachPhone">手机号</label>
                        <input type="text" id="editCoachPhone" v-model="editCoachData.phone" placeholder="请输入手机号">
                    </div>
                    <div class="form-group">
                        <label for="editCoachSubject">学科</label>
                        <select id="editCoachSubject" v-model="editCoachData.subject_id">
                            <option v-for="subject in activeSubjects" :key="subject.id" :value="subject.id">{{ subject.subject }}</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditCoachModal">取消</button>
                    <button class="save-btn" @click="saveEditCoach">保存</button>
                </div>
            </div>
        </div>

        <!-- 新增教练弹窗 -->
        <div class="modal-overlay" v-if="showAddCoachModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增教练</h3>
                    <button class="close-btn" @click="closeAddCoachModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="addCoachName">姓名 <span class="required">*</span></label>
                        <input type="text" id="addCoachName" v-model="addCoachData.name" placeholder="请输入姓名" required>
                    </div>
                    <div class="form-group">
                        <label for="addCoachSex">性别 <span class="required">*</span></label>
                        <select id="addCoachSex" v-model="addCoachData.sex_id" required>
                            <option value="">请选择性别</option>
                            <option v-for="sex in sexes" :key="sex.id" :value="sex.id">{{ sex.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addCoachPhone">电话 <span class="required">*</span></label>
                        <input type="text" id="addCoachPhone" v-model="addCoachData.phone" placeholder="请输入电话" required>
                    </div>
                    <div class="form-group">
                        <label for="addCoachSubject">学科 <span class="required">*</span></label>
                        <select id="addCoachSubject" v-model="addCoachData.subject_id" required>
                            <option value="">请选择学科</option>
                            <option v-for="subject in activeSubjects" :key="subject.id" :value="subject.id">{{ subject.subject }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addCoachStudents">学生</label>
                        <div class="multi-select">
                            <div v-for="student in activeStudents" :key="student.id" class="checkbox-item">
                                <input
                                    type="checkbox"
                                    :id="'student-' + student.id"
                                    :value="student.id"
                                    v-model="addCoachData.student_ids">
                                <label :for="'student-' + student.id">{{ student.student_name }}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddCoachModal">取消</button>
                    <button class="save-btn" @click="saveAddCoach">保存</button>
                </div>
            </div>
        </div>

        <!-- 删除确认弹窗 -->
        <div class="modal-overlay" v-if="showDeleteConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认删除</h3>
                    <button class="close-btn" @click="closeDeleteConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否确认删除该条数据？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeDeleteConfirm">取消</button>
                    <button class="delete-btn" @click="confirmDelete">确认删除</button>
                </div>
            </div>
        </div>

        <!-- 新增订单抽屉 -->
        <div class="drawer-overlay" v-if="showAddOrderDrawer" @click="closeAddOrderDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>新增订单</h3>
                    <button class="close-btn" @click="closeAddOrderDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addOrderStudentName">学生姓名 <span class="required">*</span></label>
                            <select id="addOrderStudentName" v-model="addOrderData.student_id" @change="onOrderStudentChange" class="styled-select" required>
                                <option value="">请选择学生</option>
                                <option v-for="student in activeStudentsForOrder" :key="student.id" :value="student.id">{{ student.student_name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label>UID</label>
                            <input type="text" :value="addOrderData.student_id || '选择学生后自动显示'" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addOrderExpectedPaymentTime">预计付款时间</label>
                            <input type="datetime-local" id="addOrderExpectedPaymentTime" v-model="addOrderData.expected_payment_time" @change="onExpectedPaymentTimeChange">
                        </div>
                        <div class="form-group-col">
                            <label>参加活动</label>
                            <input type="text" :value="addOrderData.participating_activities || '无'" readonly class="readonly-input" :style="{color: addOrderData.participating_activities ? '#333' : '#999'}">
                        </div>
                    </div>
                    <!-- 活动模板包含的商品展示 -->
                    <div class="form-group" v-if="orderActivityTemplateGoods.length > 0">
                        <label>活动模板包含商品（共 {{ orderActivityTemplateGoods.length }} 条）</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>所属活动</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in orderActivityTemplateGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>{{ goods.activities.join('，') }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>应收金额</label>
                            <input type="text" :value="orderTotalReceivable.toFixed(2)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>优惠金额</label>
                            <input type="text" :value="orderDiscountAmount.toFixed(2)" readonly class="readonly-input" style="color: #e74c3c; font-weight: bold;">
                        </div>
                        <div class="form-group-col">
                            <label>实收金额</label>
                            <input type="text" :value="orderTotalReceived.toFixed(2)" readonly class="readonly-input" style="color: #27ae60; font-weight: bold;">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>选择商品 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="selectedOrderGoods.length > 0">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>商品总价</th>
                                    <th>组合售卖</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(goods, index) in selectedOrderGoods" :key="goods.goods_id">
                                    <td>{{ goods.goods_id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>{{ goods.total_price }}</td>
                                    <td>{{ goods.isgroup == 0 ? '是' : '否' }}</td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeOrderGoods(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="openAddOrderGoodsModal">+ 新增商品</button>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddOrderDrawer">取消</button>
                    <button class="save-btn" @click="saveAddOrder">保存</button>
                </div>
            </div>
        </div>

        <!-- 新增订单商品子弹窗 -->
        <div class="modal-overlay" v-if="showAddOrderGoodsModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增商品</h3>
                    <button class="close-btn" @click="closeAddOrderGoodsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="orderGoodsName">商品名称 <span class="required">*</span></label>
                        <select id="orderGoodsName" v-model="addOrderGoodsData.goods_id" @change="onOrderGoodsChange" class="styled-select" required>
                            <option value="">请选择商品</option>
                            <option v-for="goods in availableGoodsForOrderSelection" :key="goods.id" :value="goods.id">{{ goods.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>品牌</label>
                        <input type="text" v-model="addOrderGoodsData.brand_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>类型</label>
                        <input type="text" v-model="addOrderGoodsData.classify_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>属性+属性值</label>
                        <input type="text" v-model="addOrderGoodsData.attributes" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>标准售价</label>
                        <input type="text" v-model="addOrderGoodsData.price" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>商品总价</label>
                        <input type="text" v-model="addOrderGoodsData.total_price" readonly class="readonly-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddOrderGoodsModal">取消</button>
                    <button class="save-btn" @click="saveOrderGoods">保存</button>
                </div>
            </div>
        </div>

        <!-- 编辑订单抽屉 -->
        <div class="drawer-overlay" v-if="showEditOrderDrawer" @click="closeEditOrderDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>{{ orderDrawerReadOnly ? '订单详情' : '编辑订单' }}</h3>
                    <button class="close-btn" @click="closeEditOrderDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>学生姓名</label>
                            <input type="text" :value="editOrderData.student_name" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>UID</label>
                            <input type="text" :value="editOrderData.student_id" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="editOrderExpectedPaymentTime">预计付款时间</label>
                            <input type="datetime-local" id="editOrderExpectedPaymentTime" v-model="editOrderData.expected_payment_time" @change="onEditExpectedPaymentTimeChange" :disabled="orderDrawerReadOnly">
                        </div>
                        <div class="form-group-col">
                            <label>参加活动</label>
                            <input type="text" :value="editOrderData.participating_activities || '无'" readonly class="readonly-input" :style="{color: editOrderData.participating_activities ? '#333' : '#999'}">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>应收金额</label>
                            <input type="text" :value="editOrderTotalReceivable.toFixed(2)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>优惠金额</label>
                            <input type="text" :value="editOrderDiscountAmount.toFixed(2)" readonly class="readonly-input" style="color: #e74c3c; font-weight: bold;">
                        </div>
                        <div class="form-group-col">
                            <label>实收金额</label>
                            <input type="text" :value="editOrderTotalReceived.toFixed(2)" readonly class="readonly-input" style="color: #27ae60; font-weight: bold;">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>选择商品 <span class="required" v-if="!orderDrawerReadOnly">*</span></label>
                        <table class="included-goods-table" v-if="editSelectedOrderGoods.length > 0">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>商品总价</th>
                                    <th>组合售卖</th>
                                    <th v-if="!orderDrawerReadOnly">操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(goods, index) in editSelectedOrderGoods" :key="goods.goods_id">
                                    <td>{{ goods.goods_id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>{{ goods.total_price }}</td>
                                    <td>{{ goods.isgroup == 0 ? '是' : '否' }}</td>
                                    <td v-if="!orderDrawerReadOnly">
                                        <button type="button" class="delete-btn" @click="removeEditOrderGoods(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button v-if="!orderDrawerReadOnly" type="button" class="add-included-btn" @click="openEditOrderGoodsModal">+ 新增商品</button>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button v-if="orderDrawerReadOnly" class="cancel-btn" @click="closeEditOrderDrawer">关闭</button>
                    <template v-else>
                        <button class="cancel-btn" @click="closeEditOrderDrawer">取消</button>
                        <button class="save-btn" @click="saveEditOrder">保存</button>
                        <button class="save-btn" @click="confirmSubmitOrder">提交</button>
                    </template>
                </div>
            </div>
        </div>

        <!-- 提交订单确认弹窗 -->
        <div class="modal-overlay" v-if="showSubmitOrderConfirm">
            <div class="modal confirm-modal">
                <div class="modal-header">
                    <h3>提交确认</h3>
                </div>
                <div class="modal-body">
                    <p>是否确认提交？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showSubmitOrderConfirm = false">取消</button>
                    <button class="save-btn" @click="submitOrder">确认</button>
                </div>
            </div>
        </div>

        <!-- 编辑订单商品子弹窗 -->
        <div class="modal-overlay" v-if="showEditOrderGoodsModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增商品</h3>
                    <button class="close-btn" @click="closeEditOrderGoodsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editOrderGoodsName">商品名称 <span class="required">*</span></label>
                        <select id="editOrderGoodsName" v-model="editOrderGoodsData.goods_id" @change="onEditOrderGoodsChange" class="styled-select" required>
                            <option value="">请选择商品</option>
                            <option v-for="goods in availableGoodsForEditOrderSelection" :key="goods.id" :value="goods.id">{{ goods.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>品牌</label>
                        <input type="text" v-model="editOrderGoodsData.brand_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>类型</label>
                        <input type="text" v-model="editOrderGoodsData.classify_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>属性+属性值</label>
                        <input type="text" v-model="editOrderGoodsData.attributes" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>标准售价</label>
                        <input type="text" v-model="editOrderGoodsData.price" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>商品总价</label>
                        <input type="text" v-model="editOrderGoodsData.total_price" readonly class="readonly-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditOrderGoodsModal">取消</button>
                    <button class="save-btn" @click="saveEditOrderGoods">保存</button>
                </div>
            </div>
        </div>

        <!-- 作废订单确认弹窗 -->
        <div class="modal-overlay" v-if="showCancelOrderConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认作废</h3>
                    <button class="close-btn" @click="closeCancelOrderConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否确认作废该订单？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeCancelOrderConfirm">否</button>
                    <button class="delete-btn" @click="confirmCancelOrder">是</button>
                </div>
            </div>
        </div>

        <!-- 新增属性弹窗 -->
        <div class="modal-overlay" v-if="showAddAttributeModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增属性</h3>
                    <button class="close-btn" @click="closeAddAttributeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="addAttributeName">名字 <span class="required">*</span></label>
                        <input type="text" id="addAttributeName" v-model="addAttributeData.name" placeholder="请输入名字" required>
                    </div>
                    <div class="form-group">
                        <label for="addAttributeClassify">分类 <span class="required">*</span></label>
                        <select id="addAttributeClassify" v-model="addAttributeData.classify" required>
                            <option value="">请选择分类</option>
                            <option value="0">属性</option>
                            <option value="1">规格</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddAttributeModal">取消</button>
                    <button class="save-btn" @click="saveAddAttribute">确定</button>
                </div>
            </div>
        </div>

        <!-- 编辑属性弹窗 -->
        <div class="modal-overlay" v-if="showEditAttributeModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>编辑属性</h3>
                    <button class="close-btn" @click="closeEditAttributeModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editAttributeName">名字 <span class="required">*</span></label>
                        <input type="text" id="editAttributeName" v-model="editAttributeData.name" placeholder="请输入名字" required>
                    </div>
                    <div class="form-group">
                        <label for="editAttributeClassify">分类 <span class="required">*</span></label>
                        <select id="editAttributeClassify" v-model="editAttributeData.classify" required>
                            <option value="">请选择分类</option>
                            <option value="0">属性</option>
                            <option value="1">规格</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditAttributeModal">取消</button>
                    <button class="save-btn" @click="saveEditAttribute">确定</button>
                </div>
            </div>
        </div>

        <!-- 启用属性确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableAttributeConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认启用</h3>
                    <button class="close-btn" @click="closeEnableAttributeConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否启用该属性？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEnableAttributeConfirm">否</button>
                    <button class="save-btn" @click="confirmEnableAttribute">是</button>
                </div>
            </div>
        </div>

        <!-- 禁用属性确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableAttributeConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认禁用</h3>
                    <button class="close-btn" @click="closeDisableAttributeConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否禁用该属性？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeDisableAttributeConfirm">否</button>
                    <button class="delete-btn" @click="confirmDisableAttribute">是</button>
                </div>
            </div>
        </div>

        <!-- 新增类型弹窗 -->
        <div class="modal-overlay" v-if="showAddClassifyModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增类型</h3>
                    <button class="close-btn" @click="closeAddClassifyModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="addClassifyName">名称 <span class="required">*</span></label>
                        <input type="text" id="addClassifyName" v-model="addClassifyData.name" placeholder="请输入名称" required>
                    </div>
                    <div class="form-group">
                        <label for="addClassifyLevel">级别 <span class="required">*</span></label>
                        <select id="addClassifyLevel" v-model="addClassifyData.level" @change="onAddClassifyLevelChange" required>
                            <option value="">请选择级别</option>
                            <option value="0">一级</option>
                            <option value="1">二级</option>
                        </select>
                    </div>
                    <div class="form-group" v-if="addClassifyData.level === '1'">
                        <label for="addClassifyParent">父级类型 <span class="required">*</span></label>
                        <select id="addClassifyParent" v-model="addClassifyData.parent_id" required>
                            <option value="">请选择父级类型</option>
                            <option v-for="parent in parentClassifies" :key="parent.id" :value="parent.id">{{ parent.name }}</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddClassifyModal">取消</button>
                    <button class="save-btn" @click="saveAddClassify">确定</button>
                </div>
            </div>
        </div>

        <!-- 编辑类型弹窗 -->
        <div class="modal-overlay" v-if="showEditClassifyModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>编辑类型</h3>
                    <button class="close-btn" @click="closeEditClassifyModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editClassifyName">名称 <span class="required">*</span></label>
                        <input type="text" id="editClassifyName" v-model="editClassifyData.name" placeholder="请输入名称" required>
                    </div>
                    <div class="form-group">
                        <label for="editClassifyLevel">级别 <span class="required">*</span></label>
                        <select id="editClassifyLevel" v-model="editClassifyData.level" @change="onEditClassifyLevelChange" required>
                            <option value="">请选择级别</option>
                            <option value="0">一级</option>
                            <option value="1">二级</option>
                        </select>
                    </div>
                    <div class="form-group" v-if="editClassifyData.level === 1 || editClassifyData.level === '1'">
                        <label for="editClassifyParent">父级类型 <span class="required">*</span></label>
                        <select id="editClassifyParent" v-model="editClassifyData.parent_id" required>
                            <option value="">请选择父级类型</option>
                            <option v-for="parent in parentClassifies" :key="parent.id" :value="parent.id">{{ parent.name }}</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditClassifyModal">取消</button>
                    <button class="save-btn" @click="saveEditClassify">确定</button>
                </div>
            </div>
        </div>

        <!-- 启用类型确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableClassifyConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认启用</h3>
                    <button class="close-btn" @click="closeEnableClassifyConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否启用该类型？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEnableClassifyConfirm">否</button>
                    <button class="save-btn" @click="confirmEnableClassify">是</button>
                </div>
            </div>
        </div>

        <!-- 禁用类型确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableClassifyConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认禁用</h3>
                    <button class="close-btn" @click="closeDisableClassifyConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否禁用该类型？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeDisableClassifyConfirm">否</button>
                    <button class="delete-btn" @click="confirmDisableClassify">是</button>
                </div>
            </div>
        </div>

        <!-- 属性值管理弹窗 -->
        <div class="modal-overlay" v-if="showAttributeValuesModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>属性值管理</h3>
                    <button class="close-btn" @click="closeAttributeValuesModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>属性名称</label>
                        <input type="text" :value="currentAttributeName" readonly>
                    </div>
                    <div class="form-group">
                        <label>属性值 <span class="required">*</span></label>
                        <div v-for="(value, index) in attributeValues" :key="index" class="value-input-row">
                            <input
                                type="text"
                                v-model="attributeValues[index]"
                                placeholder="请输入属性值"
                                class="value-input">
                            <button
                                v-if="attributeValues.length > 1"
                                class="remove-btn"
                                @click="removeAttributeValueInput(index)">-</button>
                            <button
                                v-else
                                class="clear-btn"
                                @click="clearAttributeValueInput(index)">-</button>
                            <button
                                class="add-btn"
                                @click="addAttributeValueInput"
                                v-if="index === attributeValues.length - 1">+</button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAttributeValuesModal">取消</button>
                    <button class="save-btn" @click="saveAttributeValues">保存</button>
                </div>
            </div>
        </div>

        <!-- 新增品牌弹窗 -->
        <div class="modal-overlay" v-if="showAddBrandModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增品牌</h3>
                    <button class="close-btn" @click="closeAddBrandModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="addBrandName">名称 <span class="required">*</span></label>
                        <input type="text" id="addBrandName" v-model="addBrandData.name" placeholder="请输入名称" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddBrandModal">取消</button>
                    <button class="save-btn" @click="saveAddBrand">确定</button>
                </div>
            </div>
        </div>

        <!-- 编辑品牌弹窗 -->
        <div class="modal-overlay" v-if="showEditBrandModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>编辑品牌</h3>
                    <button class="close-btn" @click="closeEditBrandModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="editBrandName">名称 <span class="required">*</span></label>
                        <input type="text" id="editBrandName" v-model="editBrandData.name" placeholder="请输入名称" required>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEditBrandModal">取消</button>
                    <button class="save-btn" @click="saveEditBrand">确定</button>
                </div>
            </div>
        </div>

        <!-- 启用品牌确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableBrandConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认启用</h3>
                    <button class="close-btn" @click="closeEnableBrandConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否启用该品牌？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEnableBrandConfirm">否</button>
                    <button class="save-btn" @click="confirmEnableBrand">是</button>
                </div>
            </div>
        </div>

        <!-- 禁用品牌确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableBrandConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认禁用</h3>
                    <button class="close-btn" @click="closeDisableBrandConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否禁用该品牌？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeDisableBrandConfirm">否</button>
                    <button class="delete-btn" @click="confirmDisableBrand">是</button>
                </div>
            </div>
        </div>

        <!-- 新增商品侧边抽屉 -->
        <div class="drawer-overlay" v-if="showAddGoodsDrawer" @click="closeAddGoodsDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>新增商品</h3>
                    <button class="close-btn" @click="closeAddGoodsDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label for="addGoodsName">名称 <span class="required">*</span></label>
                        <input type="text" id="addGoodsName" v-model="addGoodsData.name" placeholder="请输入商品名称" required>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addGoodsBrand">品牌 <span class="required">*</span></label>
                            <select id="addGoodsBrand" v-model="addGoodsData.brandid" class="styled-select" required>
                                <option value="">请选择品牌</option>
                                <option v-for="brand in activeBrands" :key="brand.id" :value="brand.id">{{ brand.name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label for="addGoodsClassify">类型 <span class="required">*</span></label>
                            <select id="addGoodsClassify" v-model="addGoodsData.classifyid" class="styled-select" required>
                                <option value="">请选择类型</option>
                                <option v-for="classify in activeClassifies" :key="classify.id" :value="classify.id">{{ classify.name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label for="addGoodsIsGroup">组合售卖 <span class="required">*</span></label>
                            <select id="addGoodsIsGroup" v-model.number="addGoodsData.isgroup" class="styled-select" @change="onIsGroupChange" required>
                                <option :value="1">否（单独售卖）</option>
                                <option :value="0">是（套餐）</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="addGoodsPrice">标准售价 <span class="required">*</span></label>
                        <input type="number" step="0.01" id="addGoodsPrice" v-model="addGoodsData.price" placeholder="请输入标准售价" required>
                    </div>
                    <div class="form-group" v-if="addGoodsData.isgroup == 0">
                        <label>商品总价（仅供参考）</label>
                        <input type="text" :value="totalGoodsPrice" readonly class="readonly-input">
                    </div>
                    <div class="form-group" v-if="addGoodsData.isgroup == 0">
                        <label>包含商品 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="selectedIncludedGoods.length > 0">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(goods, index) in selectedIncludedGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeIncludedGoods(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="openAddIncludedGoodsModal">+ 新增包含商品</button>
                    </div>
                    <div class="form-group">
                        <label>属性</label>
                        <div v-for="(row, index) in goodsAttributeRows" :key="index" class="attribute-row">
                            <select v-model="row.attributeId" @change="onRowAttributeChange(index)" class="styled-select attr-select">
                                <option value="">请选择属性</option>
                                <option v-for="attr in getAvailableAttributes(index)" :key="attr.id" :value="attr.id">{{ attr.name }}</option>
                            </select>
                            <select v-model="row.valueId" class="styled-select value-select">
                                <option value="">请选择属性值</option>
                                <option v-for="value in getAttributeValues(row.attributeId)" :key="value.id" :value="value.id">{{ value.name }}</option>
                            </select>
                            <div class="row-buttons">
                                <button type="button" class="row-add-btn" @click="addAttributeRow" v-if="index === goodsAttributeRows.length - 1">+</button>
                                <button type="button" class="row-remove-btn" @click="removeAttributeRow(index)" v-if="goodsAttributeRows.length > 1">-</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>规格</label>
                        <div v-for="(row, index) in goodsSpecRows" :key="index" class="attribute-row">
                            <select v-model="row.attributeId" @change="onRowSpecChange(index)" class="styled-select attr-select">
                                <option value="">请选择规格</option>
                                <option v-for="spec in getAvailableSpecs(index)" :key="spec.id" :value="spec.id">{{ spec.name }}</option>
                            </select>
                            <select v-model="row.valueId" class="styled-select value-select">
                                <option value="">请选择规格值</option>
                                <option v-for="value in getAttributeValues(row.attributeId)" :key="value.id" :value="value.id">{{ value.name }}</option>
                            </select>
                            <div class="row-buttons">
                                <button type="button" class="row-add-btn" @click="addSpecRow" v-if="index === goodsSpecRows.length - 1">+</button>
                                <button type="button" class="row-remove-btn" @click="removeSpecRow(index)" v-if="goodsSpecRows.length > 1">-</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddGoodsDrawer">取消</button>
                    <button class="save-btn" @click="saveAddGoods">确定</button>
                </div>
            </div>
        </div>

        <!-- 编辑商品侧边抽屉 -->
        <div class="drawer-overlay" v-if="showEditGoodsDrawer" @click="closeEditGoodsDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>编辑商品</h3>
                    <button class="close-btn" @click="closeEditGoodsDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label for="editGoodsName">名称 <span class="required">*</span></label>
                        <input type="text" id="editGoodsName" v-model="editGoodsData.name" placeholder="请输入商品名称" required>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="editGoodsBrand">品牌 <span class="required">*</span></label>
                            <select id="editGoodsBrand" v-model="editGoodsData.brandid" class="styled-select" required>
                                <option value="">请选择品牌</option>
                                <option v-for="brand in activeBrands" :key="brand.id" :value="brand.id">{{ brand.name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label for="editGoodsClassify">类型 <span class="required">*</span></label>
                            <select id="editGoodsClassify" v-model="editGoodsData.classifyid" class="styled-select" required>
                                <option value="">请选择类型</option>
                                <option v-for="classify in activeClassifies" :key="classify.id" :value="classify.id">{{ classify.name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label>组合售卖</label>
                            <select v-model.number="editGoodsData.isgroup" class="styled-select disabled-select" disabled>
                                <option :value="1">否（单独售卖）</option>
                                <option :value="0">是（套餐）</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editGoodsPrice">标准售价 <span class="required">*</span></label>
                        <input type="number" step="0.01" id="editGoodsPrice" v-model="editGoodsData.price" placeholder="请输入标准售价" required>
                    </div>
                    <div class="form-group" v-if="editGoodsData.isgroup == 0">
                        <label>商品总价（仅供参考）</label>
                        <input type="text" :value="totalGoodsPrice" readonly class="readonly-input">
                    </div>
                    <div class="form-group" v-if="editGoodsData.isgroup == 0">
                        <label>包含商品 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="selectedIncludedGoods.length > 0">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(goods, index) in selectedIncludedGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeIncludedGoods(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="openAddIncludedGoodsModal">+ 新增包含商品</button>
                    </div>
                    <div class="form-group">
                        <label>属性</label>
                        <div v-for="(row, index) in goodsAttributeRows" :key="index" class="attribute-row">
                            <select v-model="row.attributeId" @change="onRowAttributeChange(index)" class="styled-select attr-select">
                                <option value="">请选择属性</option>
                                <option v-for="attr in getAvailableAttributes(index)" :key="attr.id" :value="attr.id">{{ attr.name }}</option>
                            </select>
                            <select v-model="row.valueId" class="styled-select value-select">
                                <option value="">请选择属性值</option>
                                <option v-for="value in getAttributeValues(row.attributeId)" :key="value.id" :value="value.id">{{ value.name }}</option>
                            </select>
                            <div class="row-buttons">
                                <button type="button" class="row-add-btn" @click="addAttributeRow" v-if="index === goodsAttributeRows.length - 1">+</button>
                                <button type="button" class="row-remove-btn" @click="removeAttributeRow(index)" v-if="goodsAttributeRows.length > 1">-</button>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>规格</label>
                        <div v-for="(row, index) in goodsSpecRows" :key="index" class="attribute-row">
                            <select v-model="row.attributeId" @change="onRowSpecChange(index)" class="styled-select attr-select">
                                <option value="">请选择规格</option>
                                <option v-for="spec in getAvailableSpecs(index)" :key="spec.id" :value="spec.id">{{ spec.name }}</option>
                            </select>
                            <select v-model="row.valueId" class="styled-select value-select">
                                <option value="">请选择规格值</option>
                                <option v-for="value in getAttributeValues(row.attributeId)" :key="value.id" :value="value.id">{{ value.name }}</option>
                            </select>
                            <div class="row-buttons">
                                <button type="button" class="row-add-btn" @click="addSpecRow" v-if="index === goodsSpecRows.length - 1">+</button>
                                <button type="button" class="row-remove-btn" @click="removeSpecRow(index)" v-if="goodsSpecRows.length > 1">-</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeEditGoodsDrawer">取消</button>
                    <button class="save-btn" @click="saveEditGoods">确定</button>
                </div>
            </div>
        </div>

        <!-- 新增包含商品子弹窗 -->
        <div class="modal-overlay" v-if="showAddIncludedGoodsModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增包含商品</h3>
                    <button class="close-btn" @click="closeAddIncludedGoodsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="includedGoodsName">商品名称 <span class="required">*</span></label>
                        <select id="includedGoodsName" v-model="addIncludedGoodsData.goods_id" @change="onIncludedGoodsChange" class="styled-select" required>
                            <option value="">请选择商品</option>
                            <option v-for="goods in availableGoodsForSelection" :key="goods.id" :value="goods.id">
                                {{ goods.name }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="includedGoodsBrand">品牌</label>
                        <input type="text" id="includedGoodsBrand" v-model="addIncludedGoodsData.brand_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label for="includedGoodsClassify">类型</label>
                        <input type="text" id="includedGoodsClassify" v-model="addIncludedGoodsData.classify_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label for="includedGoodsAttributes">属性+属性值</label>
                        <input type="text" id="includedGoodsAttributes" v-model="addIncludedGoodsData.attributes" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label for="includedGoodsPrice">标准售价</label>
                        <input type="text" id="includedGoodsPrice" v-model="addIncludedGoodsData.price" readonly class="readonly-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddIncludedGoodsModal">取消</button>
                    <button class="save-btn" @click="saveIncludedGoods">保存</button>
                </div>
            </div>
        </div>

        <!-- 启用商品确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableGoodsConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认启用</h3>
                    <button class="close-btn" @click="closeEnableGoodsConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否启用该商品？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeEnableGoodsConfirm">否</button>
                    <button class="save-btn" @click="confirmEnableGoods">是</button>
                </div>
            </div>
        </div>

        <!-- 禁用商品确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableGoodsConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认禁用</h3>
                    <button class="close-btn" @click="closeDisableGoodsConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否禁用该商品？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeDisableGoodsConfirm">否</button>
                    <button class="delete-btn" @click="confirmDisableGoods">是</button>
                </div>
            </div>
        </div>

        <!-- 新增活动模板抽屉 -->
        <div class="drawer-overlay" v-if="showAddActivityTemplateDrawer" @click="closeAddActivityTemplateDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>新增活动模板</h3>
                    <button class="close-btn" @click="closeAddActivityTemplateDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label for="addTemplateName">模板名称 <span class="required">*</span></label>
                        <input type="text" id="addTemplateName" v-model="addActivityTemplateData.name" placeholder="请输入模板名称" required>
                    </div>
                    <div class="form-group-row" style="display: flex; gap: 15px;">
                        <div class="form-group-col" style="flex: 1;">
                            <label for="addTemplateType">活动类型 <span class="required">*</span></label>
                            <select id="addTemplateType" v-model="addActivityTemplateData.type" class="styled-select" required>
                                <option value="">请选择活动类型</option>
                                <option value="2">满折</option>
                                <option value="4">换购</option>
                            </select>
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label for="addTemplateSelectType">选择方式 <span class="required">*</span></label>
                            <select id="addTemplateSelectType" v-model="addActivityTemplateData.select_type" @change="onTemplateSelectTypeChange" class="styled-select" required>
                                <option value="">请选择方式</option>
                                <option value="1">按类型</option>
                                <option value="2">按商品</option>
                            </select>
                        </div>
                        <div class="form-group-col" style="flex: 1;" v-if="addActivityTemplateData.select_type == 1">
                            <label for="addTemplateClassify">选择类型 <span class="required">*</span></label>
                            <select id="addTemplateClassify" v-model="addActivityTemplateData.selected_classify_id" @change="onTemplateClassifyChange" class="styled-select">
                                <option value="">请选择类型</option>
                                <option v-for="classify in activeClassifies" :key="classify.id" :value="classify.id">{{ classify.name }}</option>
                            </select>
                        </div>
                    </div>
                    <!-- 按商品选择 -->
                    <div class="form-group" v-if="addActivityTemplateData.select_type == 2">
                        <label>选择商品 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="selectedTemplateGoods.length > 0">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(goods, index) in selectedTemplateGoods" :key="goods.goods_id">
                                    <td>{{ goods.goods_id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeTemplateGoods(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="openAddTemplateGoodsModal">+ 新增商品</button>
                    </div>
                    <!-- 类型关联的商品展示（只读） -->
                    <div class="form-group" v-if="addActivityTemplateData.select_type == 1 && templateClassifyGoods.length > 0">
                        <label>类型关联商品（共 {{ templateClassifyGoods.length }} 条）</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in paginatedTemplateClassifyGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="pagination" v-if="templateClassifyGoodsTotalPages > 1" style="margin-top: 10px;">
                            <button class="page-btn" @click="changeTemplateClassifyGoodsPage(1)" :disabled="templateClassifyGoodsCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeTemplateClassifyGoodsPage(templateClassifyGoodsCurrentPage - 1)" :disabled="templateClassifyGoodsCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ templateClassifyGoodsCurrentPage }} / {{ templateClassifyGoodsTotalPages }} 页</span>
                            <button class="page-btn" @click="changeTemplateClassifyGoodsPage(templateClassifyGoodsCurrentPage + 1)" :disabled="templateClassifyGoodsCurrentPage === templateClassifyGoodsTotalPages">下一页</button>
                            <button class="page-btn" @click="changeTemplateClassifyGoodsPage(templateClassifyGoodsTotalPages)" :disabled="templateClassifyGoodsCurrentPage === templateClassifyGoodsTotalPages">末页</button>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddActivityTemplateDrawer">取消</button>
                    <button class="save-btn" @click="saveAddActivityTemplate">保存</button>
                </div>
            </div>
        </div>

        <!-- 新增活动模板商品子弹窗 -->
        <div class="modal-overlay" v-if="showAddTemplateGoodsModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>新增商品</h3>
                    <button class="close-btn" @click="closeAddTemplateGoodsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="templateGoodsName">商品名称 <span class="required">*</span></label>
                        <select id="templateGoodsName" v-model="addTemplateGoodsData.goods_id" @change="onTemplateGoodsChange" class="styled-select" required>
                            <option value="">请选择商品</option>
                            <option v-for="goods in availableGoodsForTemplate" :key="goods.id" :value="goods.id">{{ goods.name }}</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>品牌</label>
                        <input type="text" v-model="addTemplateGoodsData.brand_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>类型</label>
                        <input type="text" v-model="addTemplateGoodsData.classify_name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>标准售价</label>
                        <input type="text" v-model="addTemplateGoodsData.price" readonly class="readonly-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddTemplateGoodsModal">取消</button>
                    <button class="save-btn" @click="saveTemplateGoods">保存</button>
                </div>
            </div>
        </div>

        <!-- 新增活动抽屉 -->
        <div class="drawer-overlay" v-if="showAddActivityDrawer" @click="closeAddActivityDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>新增活动</h3>
                    <button class="close-btn" @click="closeAddActivityDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label for="addActivityName">活动名称 <span class="required">*</span></label>
                        <input type="text" id="addActivityName" v-model="addActivityData.name" placeholder="请输入活动名称" required>
                    </div>
                    <div class="form-group-row" style="display: flex; gap: 15px;">
                        <div class="form-group-col" style="flex: 1;">
                            <label for="addActivityTemplate">活动模板 <span class="required">*</span></label>
                            <select id="addActivityTemplate" v-model="addActivityData.template_id" @change="onActivityTemplateChange" class="styled-select" required>
                                <option value="">请选择活动模板</option>
                                <option v-for="t in activeActivityTemplates" :key="t.id" :value="t.id">{{ t.name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>模板类型</label>
                            <input type="text" :value="getActivityTypeText(addActivityData.template_type)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>选择方式</label>
                            <input type="text" :value="addActivityData.template_select_type == 1 ? '按类型' : (addActivityData.template_select_type == 2 ? '按商品' : '')" readonly class="readonly-input">
                        </div>
                    </div>
                    <!-- 模板包含的商品展示（选择方式为按类型或按商品时显示） -->
                    <div class="form-group" v-if="addActivityData.template_id && (addActivityData.template_select_type == 1 || addActivityData.template_select_type == 2) && activityTemplateGoods.length > 0">
                        <label>模板包含商品（共 {{ activityTemplateGoods.length }} 条）</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in paginatedActivityTemplateGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="pagination" v-if="activityTemplateGoodsTotalPages > 1" style="margin-top: 10px;">
                            <button class="page-btn" @click="changeActivityTemplateGoodsPage(1)" :disabled="activityTemplateGoodsCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeActivityTemplateGoodsPage(activityTemplateGoodsCurrentPage - 1)" :disabled="activityTemplateGoodsCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ activityTemplateGoodsCurrentPage }} / {{ activityTemplateGoodsTotalPages }} 页</span>
                            <button class="page-btn" @click="changeActivityTemplateGoodsPage(activityTemplateGoodsCurrentPage + 1)" :disabled="activityTemplateGoodsCurrentPage === activityTemplateGoodsTotalPages">下一页</button>
                            <button class="page-btn" @click="changeActivityTemplateGoodsPage(activityTemplateGoodsTotalPages)" :disabled="activityTemplateGoodsCurrentPage === activityTemplateGoodsTotalPages">末页</button>
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addActivityStartTime">开始时间 <span class="required">*</span></label>
                            <input type="datetime-local" id="addActivityStartTime" v-model="addActivityData.start_time" required>
                        </div>
                        <div class="form-group-col">
                            <label for="addActivityEndTime">结束时间 <span class="required">*</span></label>
                            <input type="datetime-local" id="addActivityEndTime" v-model="addActivityData.end_time" required>
                        </div>
                    </div>
                    <!-- 满折规则表格 -->
                    <div class="form-group" v-if="addActivityData.template_type == 2">
                        <label>优惠规则 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="addActivityData.details.length > 0">
                            <thead>
                                <tr>
                                    <th>数量</th>
                                    <th>折扣(折)</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(detail, index) in addActivityData.details" :key="index">
                                    <td><input type="number" v-model="detail.threshold_amount" step="1" min="1" style="width:100px;"></td>
                                    <td><input type="number" v-model="detail.discount_value" step="0.01" min="0" max="10" style="width:100px;"></td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeActivityDetail(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="addActivityDetail">+ 新增规则</button>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddActivityDrawer">取消</button>
                    <button class="save-btn" @click="saveAddActivity">保存</button>
                </div>
            </div>
        </div>

        <!-- 编辑活动抽屉 -->
        <div class="drawer-overlay" v-if="showEditActivityDrawer" @click="closeEditActivityDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>编辑活动</h3>
                    <button class="close-btn" @click="closeEditActivityDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label for="editActivityName">活动名称 <span class="required">*</span></label>
                        <input type="text" id="editActivityName" v-model="editActivityData.name" placeholder="请输入活动名称" required>
                    </div>
                    <div class="form-group">
                        <label for="editActivityTemplate">活动模板 <span class="required">*</span></label>
                        <select id="editActivityTemplate" v-model="editActivityData.template_id" @change="onEditActivityTemplateChange" class="styled-select" required>
                            <option value="">请选择活动模板</option>
                            <option v-for="t in activeActivityTemplates" :key="t.id" :value="t.id">{{ t.name }}</option>
                        </select>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>模板类型</label>
                            <input type="text" :value="getActivityTypeText(editActivityData.template_type)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>选择方式</label>
                            <input type="text" :value="editActivityData.template_select_type == 1 ? '按类型' : (editActivityData.template_select_type == 2 ? '按商品' : '')" readonly class="readonly-input">
                        </div>
                    </div>
                    <!-- 模板包含的商品展示 -->
                    <div class="form-group" v-if="editActivityData.template_id && editActivityTemplateGoods.length > 0">
                        <label>模板包含商品</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in editActivityTemplateGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="editActivityStartTime">开始时间 <span class="required">*</span></label>
                            <input type="datetime-local" id="editActivityStartTime" v-model="editActivityData.start_time" required>
                        </div>
                        <div class="form-group-col">
                            <label for="editActivityEndTime">结束时间 <span class="required">*</span></label>
                            <input type="datetime-local" id="editActivityEndTime" v-model="editActivityData.end_time" required>
                        </div>
                    </div>
                    <!-- 满折规则表格 -->
                    <div class="form-group" v-if="editActivityData.template_type == 2">
                        <label>优惠规则 <span class="required">*</span></label>
                        <table class="included-goods-table" v-if="editActivityData.details.length > 0">
                            <thead>
                                <tr>
                                    <th>数量</th>
                                    <th>折扣(折)</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(detail, index) in editActivityData.details" :key="index">
                                    <td><input type="number" v-model="detail.threshold_amount" step="1" min="1" style="width:100px;"></td>
                                    <td><input type="number" v-model="detail.discount_value" step="0.01" min="0" max="10" style="width:100px;"></td>
                                    <td>
                                        <button type="button" class="delete-btn" @click="removeEditActivityDetail(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <button type="button" class="add-included-btn" @click="addEditActivityDetail">+ 新增规则</button>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeEditActivityDrawer">取消</button>
                    <button class="save-btn" @click="saveEditActivity">保存</button>
                </div>
            </div>
        </div>

        <!-- 活动模板详情抽屉 -->
        <div class="drawer-overlay" v-if="showActivityTemplateDetailDrawer" @click="closeActivityTemplateDetailDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>活动模板详情</h3>
                    <button class="close-btn" @click="closeActivityTemplateDetailDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label>模板ID</label>
                        <input type="text" :value="activityTemplateDetailData.id" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>模板名称</label>
                        <input type="text" :value="activityTemplateDetailData.name" readonly class="readonly-input">
                    </div>
                    <div class="form-group-row" style="display: flex; gap: 15px;">
                        <div class="form-group-col" style="flex: 1;">
                            <label>活动类型</label>
                            <input type="text" :value="getActivityTypeText(activityTemplateDetailData.type)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>选择方式</label>
                            <input type="text" :value="activityTemplateDetailData.select_type == 1 ? '按类型' : '按商品'" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>状态</label>
                            <input type="text" :value="activityTemplateDetailData.status === 0 ? '启用' : '禁用'" readonly class="readonly-input">
                        </div>
                    </div>
                    <!-- 类型列表 -->
                    <div class="form-group" v-if="activityTemplateDetailData.select_type == 1 && activityTemplateDetailData.classifies.length > 0">
                        <label>关联类型</label>
                        <div style="padding: 10px; background: #f5f5f5; border-radius: 4px;">
                            <span v-for="(c, index) in activityTemplateDetailData.classifies" :key="c.classify_id">
                                {{ c.classify_name }}<span v-if="index < activityTemplateDetailData.classifies.length - 1">、</span>
                            </span>
                        </div>
                    </div>
                    <!-- 商品列表 -->
                    <div class="form-group" v-if="activityTemplateDetailData.goods.length > 0">
                        <label>关联商品（共 {{ activityTemplateDetailData.goods.length }} 条）</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in paginatedTemplateDetailGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="pagination" v-if="templateDetailGoodsTotalPages > 1" style="margin-top: 10px;">
                            <button class="page-btn" @click="changeTemplateDetailGoodsPage(1)" :disabled="templateDetailGoodsCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeTemplateDetailGoodsPage(templateDetailGoodsCurrentPage - 1)" :disabled="templateDetailGoodsCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ templateDetailGoodsCurrentPage }} / {{ templateDetailGoodsTotalPages }} 页</span>
                            <button class="page-btn" @click="changeTemplateDetailGoodsPage(templateDetailGoodsCurrentPage + 1)" :disabled="templateDetailGoodsCurrentPage === templateDetailGoodsTotalPages">下一页</button>
                            <button class="page-btn" @click="changeTemplateDetailGoodsPage(templateDetailGoodsTotalPages)" :disabled="templateDetailGoodsCurrentPage === templateDetailGoodsTotalPages">末页</button>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeActivityTemplateDetailDrawer">关闭</button>
                </div>
            </div>
        </div>

        <!-- 活动详情抽屉 -->
        <div class="drawer-overlay" v-if="showActivityDetailDrawer" @click="closeActivityDetailDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>活动详情</h3>
                    <button class="close-btn" @click="closeActivityDetailDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group">
                        <label>活动ID</label>
                        <input type="text" :value="activityDetailData.id" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>活动名称</label>
                        <input type="text" :value="activityDetailData.name" readonly class="readonly-input">
                    </div>
                    <div class="form-group-row" style="display: flex; gap: 15px;">
                        <div class="form-group-col" style="flex: 1;">
                            <label>活动模板</label>
                            <input type="text" :value="activityDetailData.template_name" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>模板类型</label>
                            <input type="text" :value="getActivityTypeText(activityDetailData.template_type)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col" style="flex: 1;">
                            <label>选择方式</label>
                            <input type="text" :value="activityDetailData.template_select_type == 1 ? '按类型' : '按商品'" readonly class="readonly-input">
                        </div>
                    </div>
                    <!-- 商品列表 -->
                    <div class="form-group" v-if="activityDetailData.goods && activityDetailData.goods.length > 0">
                        <label>模板包含商品（共 {{ activityDetailData.goods.length }} 条）<span v-if="activityDetailData.template_select_type == 1" style="color: #666; font-weight: normal;">（按类型关联）</span></label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>标准售价</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="goods in paginatedActivityDetailGoods" :key="goods.id">
                                    <td>{{ goods.id }}</td>
                                    <td>{{ goods.name }}</td>
                                    <td>{{ goods.price }}</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="pagination" v-if="activityDetailGoodsTotalPages > 1" style="margin-top: 10px;">
                            <button class="page-btn" @click="changeActivityDetailGoodsPage(1)" :disabled="activityDetailGoodsCurrentPage === 1">首页</button>
                            <button class="page-btn" @click="changeActivityDetailGoodsPage(activityDetailGoodsCurrentPage - 1)" :disabled="activityDetailGoodsCurrentPage === 1">上一页</button>
                            <span class="page-info">第 {{ activityDetailGoodsCurrentPage }} / {{ activityDetailGoodsTotalPages }} 页</span>
                            <button class="page-btn" @click="changeActivityDetailGoodsPage(activityDetailGoodsCurrentPage + 1)" :disabled="activityDetailGoodsCurrentPage === activityDetailGoodsTotalPages">下一页</button>
                            <button class="page-btn" @click="changeActivityDetailGoodsPage(activityDetailGoodsTotalPages)" :disabled="activityDetailGoodsCurrentPage === activityDetailGoodsTotalPages">末页</button>
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>开始时间</label>
                            <input type="text" :value="activityDetailData.start_time" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>结束时间</label>
                            <input type="text" :value="activityDetailData.end_time" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>状态</label>
                        <input type="text" :value="activityDetailData.status === 0 ? '启用' : '禁用'" readonly class="readonly-input">
                    </div>
                    <!-- 满折规则表格 -->
                    <div class="form-group" v-if="activityDetailData.template_type == 2 && activityDetailData.details.length > 0">
                        <label>优惠规则</label>
                        <table class="included-goods-table">
                            <thead>
                                <tr>
                                    <th>数量</th>
                                    <th>折扣(折)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="detail in activityDetailData.details" :key="detail.id">
                                    <td>{{ detail.threshold_amount }}</td>
                                    <td>{{ detail.discount_value }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeActivityDetailDrawer">关闭</button>
                </div>
            </div>
        </div>

        <!-- 新增合同抽屉 -->
        <div class="drawer-overlay" v-if="showAddContractDrawer" @click="closeAddContractDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>新增合同</h3>
                    <button class="close-btn" @click="closeAddContractDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addContractStudent">学生姓名 <span class="required">*</span></label>
                            <select id="addContractStudent" v-model="addContractData.student_id" @change="onContractStudentChange" class="styled-select" required>
                                <option value="">请选择学生</option>
                                <option v-for="student in activeStudentsForOrder" :key="student.id" :value="student.id">{{ student.student_name }}</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label>UID</label>
                            <input type="text" :value="addContractData.student_id || '选择学生后自动显示'" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label for="addContractType">合同类型 <span class="required">*</span></label>
                            <select id="addContractType" v-model="addContractData.type" @change="updateContractName" class="styled-select" required>
                                <option value="">请选择合同类型</option>
                                <option value="0">首报</option>
                                <option value="1">续报</option>
                            </select>
                        </div>
                        <div class="form-group-col">
                            <label for="addContractSignatureForm">签署形式 <span class="required">*</span></label>
                            <select id="addContractSignatureForm" v-model="addContractData.signature_form" @change="updateContractName" class="styled-select" required>
                                <option value="">请选择签署形式</option>
                                <option value="0">线上签署</option>
                                <option value="1">线下签署</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="addContractName">合同名称 <span class="required">*</span></label>
                        <input
                            type="text"
                            id="addContractName"
                            v-model="addContractData.name"
                            :readonly="addContractData.signature_form == 1"
                            :class="{'readonly-input': addContractData.signature_form == 1}"
                            placeholder="请输入合同名称"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="addContractAmount">合同金额 <span class="required">*</span></label>
                        <input
                            type="number"
                            id="addContractAmount"
                            v-model="addContractData.contract_amount"
                            step="0.01"
                            min="0"
                            placeholder="请输入合同金额"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="addContractSignatory">签署方 <span class="required">*</span></label>
                        <input
                            type="text"
                            id="addContractSignatory"
                            v-model="addContractData.signatory"
                            :readonly="addContractData.signature_form == 0"
                            :class="{'readonly-input': addContractData.signature_form == 0}"
                            placeholder="请输入签署方"
                            required>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddContractDrawer">关闭</button>
                    <button class="save-btn" @click="confirmSubmitContract">提交</button>
                </div>
            </div>
        </div>

        <!-- 合同详情抽屉 -->
        <div class="drawer-overlay" v-if="showContractDetailDrawer" @click="closeContractDetailDrawer">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>合同详情</h3>
                    <button class="close-btn" @click="closeContractDetailDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>学生姓名</label>
                            <input type="text" :value="contractDetailData.student_name" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>UID</label>
                            <input type="text" :value="contractDetailData.student_id" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>合同类型</label>
                            <input type="text" :value="getContractTypeText(contractDetailData.type)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>签署形式</label>
                            <input type="text" :value="getSignatureFormText(contractDetailData.signature_form)" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>合同名称</label>
                        <input type="text" :value="contractDetailData.name" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>合同金额</label>
                        <input type="text" :value="contractDetailData.contract_amount" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>签署方</label>
                        <input type="text" :value="contractDetailData.signatory" readonly class="readonly-input">
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>发起方</label>
                            <input type="text" :value="contractDetailData.initiating_party || '-'" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>发起人</label>
                            <input type="text" :value="contractDetailData.initiator" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group-row">
                        <div class="form-group-col">
                            <label>合同状态</label>
                            <input type="text" :value="getContractStatusText(contractDetailData.status)" readonly class="readonly-input">
                        </div>
                        <div class="form-group-col">
                            <label>付款状态</label>
                            <input type="text" :value="getPaymentStatusText(contractDetailData.payment_status)" readonly class="readonly-input">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>创建时间</label>
                        <input type="text" :value="formatDateTime(contractDetailData.create_time)" readonly class="readonly-input">
                    </div>
                </div>
                <div class="drawer-footer">
                    <!-- 线下签署 + 已通过状态：显示中止合作按钮 -->
                    <button
                        v-if="contractDetailData.signature_form == 1 && contractDetailData.status == 50"
                        class="delete-btn"
                        @click="openTerminateContractModal">
                        中止合作
                    </button>
                    <!-- 待审核状态：显示撤销按钮 -->
                    <button
                        v-if="contractDetailData.status == 0"
                        class="delete-btn"
                        @click="confirmRevokeContract">
                        撤销
                    </button>
                    <button class="cancel-btn" @click="closeContractDetailDrawer">关闭</button>
                </div>
            </div>
        </div>

        <!-- 提交合同确认弹窗 -->
        <div class="modal-overlay" v-if="showSubmitContractConfirm">
            <div class="modal confirm-modal">
                <div class="modal-header">
                    <h3>提交确认</h3>
                </div>
                <div class="modal-body">
                    <p>是否确认提交审核？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showSubmitContractConfirm = false">取消</button>
                    <button class="save-btn" @click="submitContract">确认</button>
                </div>
            </div>
        </div>

        <!-- 撤销合同确认弹窗 -->
        <div class="modal-overlay" v-if="showRevokeContractConfirm">
            <div class="modal confirm-modal">
                <div class="modal-header">
                    <h3>撤销确认</h3>
                </div>
                <div class="modal-body">
                    <p>是否确认撤销？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showRevokeContractConfirm = false">取消</button>
                    <button class="delete-btn" @click="revokeContract">确认</button>
                </div>
            </div>
        </div>

        <!-- 中止合作弹窗 -->
        <div class="modal-overlay" v-if="showTerminateContractModal">
            <div class="modal">
                <div class="modal-header">
                    <h3>中止合作</h3>
                    <button class="close-btn" @click="closeTerminateContractModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="terminationAgreement">中止协议 <span class="required">*</span></label>
                        <input
                            type="file"
                            id="terminationAgreement"
                            accept=".pdf"
                            @change="handleTerminationFileUpload"
                            required>
                        <p style="color: #999; font-size: 12px; margin-top: 5px;">仅支持上传PDF文件</p>
                        <p v-if="terminationAgreementFile" style="color: #27ae60; font-size: 12px; margin-top: 5px;">
                            已选择文件：{{ terminationAgreementFile.name }}
                        </p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeTerminateContractModal">取消</button>
                    <button class="save-btn" @click="terminateContract">确认</button>
                </div>
            </div>
        </div>

        <!-- 新增收款弹窗 -->
        <div class="modal-overlay" v-if="showAddPaymentCollectionModal">
            <div class="modal" style="width: 500px;">
                <div class="modal-header">
                    <h3>新增收款</h3>
                    <button class="close-btn" @click="closeAddPaymentCollectionModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>学生姓名 <span class="required">*</span></label>
                        <select v-model="paymentCollectionForm.student_id" @change="onPaymentStudentChange">
                            <option value="">请选择学生</option>
                            <option v-for="student in activeStudents" :key="student.id" :value="student.id">
                                {{ student.student_name }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>UID</label>
                        <input type="text" :value="paymentCollectionForm.student_id" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>订单ID <span class="required">*</span></label>
                        <select v-model="paymentCollectionForm.order_id" @change="onPaymentOrderChange">
                            <option value="">请选择订单</option>
                            <option v-for="order in studentUnpaidOrders" :key="order.id" :value="order.id">
                                {{ order.id }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>待支付金额</label>
                        <input type="text" :value="paymentCollectionForm.pending_amount" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>付款场景 <span class="required">*</span></label>
                        <select v-model="paymentCollectionForm.payment_scenario" @change="onPaymentScenarioChange">
                            <option value="">请选择</option>
                            <option value="0" v-if="canSelectOnlinePayment">线上</option>
                            <option value="1">线下</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>付款方式 <span class="required">*</span></label>
                        <select v-model="paymentCollectionForm.payment_method">
                            <option value="">请选择</option>
                            <template v-if="paymentCollectionForm.payment_scenario === '0'">
                                <option value="0">微信</option>
                                <option value="1">支付宝</option>
                                <option value="3">零零购支付</option>
                                <option value="2">优利支付</option>
                            </template>
                            <template v-if="paymentCollectionForm.payment_scenario === '1'">
                                <option value="0">微信</option>
                                <option value="1">支付宝</option>
                                <option value="9">对公转账</option>
                                <option value="3">零零购支付</option>
                                <option value="2">优利支付</option>
                            </template>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>付款金额 <span class="required">*</span></label>
                        <input type="number" step="0.01" v-model="paymentCollectionForm.payment_amount" placeholder="请输入付款金额">
                    </div>
                    <div class="form-group">
                        <label>付款人</label>
                        <input type="text" v-model="paymentCollectionForm.payer" placeholder="请输入付款人">
                    </div>
                    <div class="form-group">
                        <label>收款主体 <span class="required">*</span></label>
                        <select v-model="paymentCollectionForm.payee_entity">
                            <option value="">请选择</option>
                            <option value="0">北京</option>
                            <option value="1">西安</option>
                        </select>
                    </div>
                    <div class="form-group" v-if="paymentCollectionForm.payment_scenario === '1'">
                        <label>商户订单号 <span class="required">*</span></label>
                        <input type="text" v-model="paymentCollectionForm.merchant_order" placeholder="请输入商户订单号">
                    </div>
                    <div class="form-group" v-if="paymentCollectionForm.payment_scenario === '1'">
                        <label>交易时间</label>
                        <input type="date" v-model="paymentCollectionForm.trading_hours">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeAddPaymentCollectionModal">取消</button>
                    <button class="save-btn" @click="submitPaymentCollection">确认</button>
                </div>
            </div>
        </div>

        <!-- 确认到账弹窗 -->
        <div class="modal-overlay" v-if="showConfirmPaymentModal">
            <div class="modal confirm-modal">
                <div class="modal-header">
                    <h3>确认到账</h3>
                </div>
                <div class="modal-body">
                    <p>是否确认到账？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showConfirmPaymentModal = false">取消</button>
                    <button class="save-btn" @click="doConfirmPayment">确认</button>
                </div>
            </div>
        </div>

        <!-- 删除收款确认弹窗 -->
        <div class="modal-overlay" v-if="showDeletePaymentModal">
            <div class="modal confirm-modal">
                <div class="modal-header">
                    <h3>删除确认</h3>
                </div>
                <div class="modal-body">
                    <p>是否确认删除？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDeletePaymentModal = false">取消</button>
                    <button class="delete-btn" @click="doDeletePayment">确认</button>
                </div>
            </div>
        </div>

        <!-- 认领确认弹窗 -->
        <div class="modal-overlay" v-if="showClaimConfirmModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认认领</h2>
                </div>
                <div class="modal-body">
                    <p>请输入要关联的订单ID：</p>
                    <div class="form-group">
                        <label for="claimOrderId">订单ID <span class="required">*</span></label>
                        <input type="number" id="claimOrderId" v-model="claimOrderId" placeholder="请输入订单ID" required>
                    </div>
                    <p style="color: #666; font-size: 14px; margin-top: 10px;">
                        注意：订单状态必须为"未支付"或"部分支付"，且认领金额不能超过订单待支付金额。
                    </p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showClaimConfirmModal = false; claimOrderId = ''">取消</button>
                    <button class="save-btn" @click="doClaimUnclaimed">确认</button>
                </div>
            </div>
        </div>

        <!-- 删除待认领确认弹窗 -->
        <div class="modal-overlay" v-if="showDeleteUnclaimedModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认删除</h2>
                </div>
                <div class="modal-body">
                    <p>是否确认删除？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDeleteUnclaimedModal = false">取消</button>
                    <button class="delete-btn" @click="doDeleteUnclaimed">确认</button>
                </div>
            </div>
        </div>

        <!-- 淘宝新增收款弹窗 -->
        <div class="modal-overlay" v-if="showAddTaobaoPaymentModal">
            <div class="modal" style="width: 500px;">
                <div class="modal-header">
                    <h3>新增淘宝收款</h3>
                    <button class="close-btn" @click="showAddTaobaoPaymentModal = false">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>学生姓名 <span class="required">*</span></label>
                        <select v-model="taobaoPaymentForm.student_id" @change="onTaobaoStudentChange">
                            <option value="">请选择学生</option>
                            <option v-for="student in activeStudents" :key="student.id" :value="student.id">
                                {{ student.student_name }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>UID</label>
                        <input type="text" :value="taobaoPaymentForm.student_id" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>订单ID <span class="required">*</span></label>
                        <select v-model="taobaoPaymentForm.order_id" @change="onTaobaoOrderChange">
                            <option value="">请选择订单</option>
                            <option v-for="order in studentUnpaidOrders" :key="order.id" :value="order.id">
                                {{ order.id }}
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>待支付金额</label>
                        <input type="text" :value="taobaoPaymentForm.pending_amount" readonly class="readonly-input">
                    </div>
                    <div class="form-group">
                        <label>付款方</label>
                        <input type="text" v-model="taobaoPaymentForm.payer" placeholder="请输入付款方">
                    </div>
                    <div class="form-group">
                        <label>支付宝账号</label>
                        <input type="text" v-model="taobaoPaymentForm.zhifubao_account" placeholder="请输入支付宝账号">
                    </div>
                    <div class="form-group">
                        <label>付款金额 <span class="required">*</span></label>
                        <input type="number" step="0.01" v-model="taobaoPaymentForm.payment_amount" placeholder="请输入付款金额">
                    </div>
                    <div class="form-group">
                        <label>下单时间 <span class="required">*</span></label>
                        <input type="datetime-local" v-model="taobaoPaymentForm.order_time">
                    </div>
                    <div class="form-group">
                        <label>商户订单号</label>
                        <input type="text" v-model="taobaoPaymentForm.merchant_order" placeholder="请输入商户订单号">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showAddTaobaoPaymentModal = false">取消</button>
                    <button class="save-btn" @click="addTaobaoPayment">确认</button>
                </div>
            </div>
        </div>

        <!-- 确认淘宝到账弹窗 -->
        <div class="modal-overlay" v-if="showConfirmTaobaoPaymentModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认到账</h2>
                </div>
                <div class="modal-body">
                    <p>是否确认该笔款项已到账？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showConfirmTaobaoPaymentModal = false">取消</button>
                    <button class="confirm-btn" @click="doConfirmTaobaoPayment">确认</button>
                </div>
            </div>
        </div>

        <!-- 删除淘宝收款确认弹窗 -->
        <div class="modal-overlay" v-if="showDeleteTaobaoPaymentModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认删除</h2>
                </div>
                <div class="modal-body">
                    <p>是否确认删除该淘宝收款记录？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDeleteTaobaoPaymentModal = false">取消</button>
                    <button class="delete-btn" @click="doDeleteTaobaoPayment">确认</button>
                </div>
            </div>
        </div>

        <!-- 认领淘宝待认领弹窗 -->
        <div class="modal-overlay" v-if="showClaimTaobaoModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>认领待认领款项</h2>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="claimTaobaoOrderId">订单ID <span style="color: red;">*</span></label>
                        <input type="number" id="claimTaobaoOrderId" v-model="claimTaobaoOrderId" placeholder="请输入要关联的订单ID">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showClaimTaobaoModal = false">取消</button>
                    <button class="confirm-btn" @click="doClaimTaobaoUnclaimed">确认</button>
                </div>
            </div>
        </div>

        <!-- 删除淘宝待认领确认弹窗 -->
        <div class="modal-overlay" v-if="showDeleteTaobaoUnclaimedModal">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认删除</h2>
                </div>
                <div class="modal-body">
                    <p>是否确认删除该待认领记录？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDeleteTaobaoUnclaimedModal = false">取消</button>
                    <button class="delete-btn" @click="doDeleteTaobaoUnclaimed">确认</button>
                </div>
            </div>
        </div>

        <!-- 新增审批流模板弹窗 -->
        <div class="drawer-overlay" v-if="showAddApprovalFlowTemplateDrawer" @click="closeAddApprovalFlowTemplateDrawer">
            <div class="drawer drawer-large" @click.stop>
                <div class="drawer-header">
                    <h3>新增审批流</h3>
                    <button class="close-btn" @click="closeAddApprovalFlowTemplateDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <!-- 模板名称和审批流类型在一行 -->
                    <div class="form-row">
                        <div class="form-group" style="flex: 1;">
                            <label>模板名称 <span class="required">*</span></label>
                            <input type="text" v-model="addApprovalFlowTemplateData.name" placeholder="请输入模板名称" required>
                        </div>
                        <div class="form-group" style="flex: 1; margin-left: 15px;">
                            <label>审批流类型 <span class="required">*</span></label>
                            <select v-model="addApprovalFlowTemplateData.approval_flow_type_id" class="styled-select" required>
                                <option value="">请选择审批流类型</option>
                                <option v-for="type in activeApprovalFlowTypes" :key="type.id" :value="type.id">{{ type.name }}</option>
                            </select>
                        </div>
                    </div>

                    <!-- 流程设置 -->
                    <div class="form-group">
                        <label>流程设置 <span class="required">*</span></label>
                        <div class="approval-nodes">
                            <div v-for="(node, nodeIndex) in addApprovalFlowTemplateData.nodes" :key="nodeIndex" class="approval-node">
                                <div class="node-header">
                                    <h4>节点{{ nodeIndex + 1 }}</h4>
                                    <div class="node-actions">
                                        <button type="button" class="add-node-btn" @click="addApprovalNode">+</button>
                                        <button type="button" class="remove-node-btn" @click="removeApprovalNode(nodeIndex)" :disabled="addApprovalFlowTemplateData.nodes.length === 1">-</button>
                                    </div>
                                </div>
                                <div class="node-content">
                                    <!-- 节点名称和审批类型在一行 -->
                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label>节点名称 <span class="required">*</span></label>
                                            <input type="text" v-model="node.name" placeholder="请输入节点名称" required>
                                        </div>
                                        <div class="form-group" style="flex: 1; margin-left: 15px;">
                                            <label>审批类型 <span class="required">*</span></label>
                                            <select v-model="node.type" class="styled-select" required>
                                                <option value="0">会签</option>
                                                <option value="1">或签</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>审批人员 <span class="required">*</span></label>
                                        <div class="approver-list">
                                            <div v-for="(approver, approverIndex) in node.approvers" :key="approverIndex" class="approver-item">
                                                <select v-model="node.approvers[approverIndex]" class="styled-select" required>
                                                    <option value="">请选择审批人员</option>
                                                    <option v-for="user in activeUserAccounts" :key="user.id" :value="user.id">{{ user.username }}</option>
                                                </select>
                                                <button type="button" class="add-approver-btn" @click="addApprover(nodeIndex)">+</button>
                                                <button type="button" class="remove-approver-btn" @click="removeApprover(nodeIndex, approverIndex)" :disabled="node.approvers.length === 1">-</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 抄送 -->
                            <div class="approval-node copy-section">
                                <div class="node-header">
                                    <h4>抄送</h4>
                                </div>
                                <div class="node-content">
                                    <div class="form-group">
                                        <label>抄送人员</label>
                                        <div class="approver-list">
                                            <div v-for="(copyUser, copyIndex) in addApprovalFlowTemplateData.copy_users" :key="copyIndex" class="approver-item">
                                                <select v-model="addApprovalFlowTemplateData.copy_users[copyIndex]" class="styled-select">
                                                    <option value="">请选择抄送人员</option>
                                                    <option v-for="user in activeUserAccounts" :key="user.id" :value="user.id">{{ user.username }}</option>
                                                </select>
                                                <button type="button" class="add-approver-btn" @click="addCopyUser">+</button>
                                                <button type="button" class="remove-approver-btn" @click="removeCopyUser(copyIndex)">-</button>
                                            </div>
                                            <button v-if="addApprovalFlowTemplateData.copy_users.length === 0" type="button" class="add-included-btn" @click="addCopyUser">+ 添加抄送人员</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeAddApprovalFlowTemplateDrawer">取消</button>
                    <button class="save-btn" @click="saveApprovalFlowTemplate">保存</button>
                </div>
            </div>
        </div>

        <!-- 查看审批流模板详情弹窗 -->
        <div class="drawer-overlay" v-if="showViewApprovalFlowTemplateDrawer" @click="closeViewApprovalFlowTemplateDrawer">
            <div class="drawer drawer-large" @click.stop>
                <div class="drawer-header">
                    <h3>审批流详情</h3>
                    <button class="close-btn" @click="closeViewApprovalFlowTemplateDrawer">&times;</button>
                </div>
                <div class="drawer-body">
                    <!-- 模板名称和审批流类型在一行 -->
                    <div class="form-row">
                        <div class="form-group" style="flex: 1;">
                            <label>模板名称</label>
                            <input type="text" :value="viewApprovalFlowTemplateData.name" readonly disabled>
                        </div>
                        <div class="form-group" style="flex: 1; margin-left: 15px;">
                            <label>审批流类型</label>
                            <input type="text" :value="viewApprovalFlowTemplateData.flow_type_name" readonly disabled>
                        </div>
                    </div>

                    <!-- 流程设置 -->
                    <div class="form-group">
                        <label>流程设置</label>
                        <div class="approval-nodes">
                            <div v-for="(node, nodeIndex) in viewApprovalFlowTemplateData.nodes" :key="nodeIndex" class="approval-node">
                                <div class="node-header">
                                    <h4>节点{{ nodeIndex + 1 }}</h4>
                                </div>
                                <div class="node-content">
                                    <!-- 节点名称和审批类型在一行 -->
                                    <div class="form-row">
                                        <div class="form-group" style="flex: 1;">
                                            <label>节点名称</label>
                                            <input type="text" :value="node.name" readonly disabled>
                                        </div>
                                        <div class="form-group" style="flex: 1; margin-left: 15px;">
                                            <label>审批类型</label>
                                            <input type="text" :value="node.type === 0 ? '会签' : '或签'" readonly disabled>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>审批人员</label>
                                        <div class="approver-list">
                                            <div v-for="(approver, approverIndex) in node.approvers" :key="approverIndex" class="approver-item">
                                                <input type="text" :value="approver.username" readonly disabled>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 抄送 -->
                            <div v-if="viewApprovalFlowTemplateData.copy_users.length > 0" class="approval-node copy-section">
                                <div class="node-header">
                                    <h4>抄送</h4>
                                </div>
                                <div class="node-content">
                                    <div class="form-group">
                                        <label>抄送人员</label>
                                        <div class="approver-list">
                                            <div v-for="(copyUser, copyIndex) in viewApprovalFlowTemplateData.copy_users" :key="copyIndex" class="approver-item">
                                                <input type="text" :value="copyUser.username" readonly disabled>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeViewApprovalFlowTemplateDrawer">关闭</button>
                </div>
            </div>
        </div>

        <!-- 启用审批流类型确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableFlowTypeConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认启用</h2>
                </div>
                <div class="modal-body">
                    <p>是否启用该审批流类型？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showEnableFlowTypeConfirm = false">取消</button>
                    <button class="confirm-btn" @click="doEnableFlowType">确认</button>
                </div>
            </div>
        </div>

        <!-- 禁用审批流类型确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableFlowTypeConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认禁用</h2>
                </div>
                <div class="modal-body">
                    <p>是否禁用该审批流类型？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDisableFlowTypeConfirm = false">取消</button>
                    <button class="delete-btn" @click="doDisableFlowType">确认</button>
                </div>
            </div>
        </div>

        <!-- 启用审批流模板确认弹窗 -->
        <div class="modal-overlay" v-if="showEnableFlowTemplateConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认启用</h2>
                </div>
                <div class="modal-body">
                    <p>是否启用该审批流模板？</p>
                    <p style="color: #e74c3c; font-size: 14px;">注意：相同类型的审批流模板仅可生效一个，启用后将自动禁用其他同类型模板。</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showEnableFlowTemplateConfirm = false">取消</button>
                    <button class="confirm-btn" @click="doEnableFlowTemplate">确认</button>
                </div>
            </div>
        </div>

        <!-- 禁用审批流模板确认弹窗 -->
        <div class="modal-overlay" v-if="showDisableFlowTemplateConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h2>确认禁用</h2>
                </div>
                <div class="modal-body">
                    <p>是否禁用该审批流模板？</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="showDisableFlowTemplateConfirm = false">取消</button>
                    <button class="delete-btn" @click="doDisableFlowTemplate">确认</button>
                </div>
            </div>
        </div>

        <!-- 退款订单详情弹窗 -->
        <div class="drawer-overlay" v-if="showRefundOrderDetail" @click="closeRefundOrderDetail">
            <div class="drawer drawer-large" @click.stop>
                <div class="drawer-header">
                    <h3>退款订单详情</h3>
                    <button class="close-btn" @click="closeRefundOrderDetail">&times;</button>
                </div>
                <div class="drawer-body">
                    <!-- 状态标签 -->
                    <div class="refund-section">
                        <div class="section-header">
                            <h4>退款状态</h4>
                            <span class="status-badge" :class="'status-' + refundOrderDetail.status">
                                {{ getRefundOrderStatusText(refundOrderDetail.status) }}
                            </span>
                        </div>
                    </div>

                    <!-- 基本信息 -->
                    <div class="refund-section">
                        <h4>基本信息</h4>
                        <div class="form-group-row">
                            <div class="form-group-col">
                                <label>退款订单ID</label>
                                <input type="text" :value="refundOrderDetail.id" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>订单ID</label>
                                <input type="text" :value="refundOrderDetail.order_id" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>UID</label>
                                <input type="text" :value="refundOrderDetail.student_id" readonly class="readonly-input">
                            </div>
                        </div>
                        <div class="form-group-row">
                            <div class="form-group-col">
                                <label>学生姓名</label>
                                <input type="text" :value="refundOrderDetail.student_name" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>年级</label>
                                <input type="text" :value="refundOrderDetail.grade" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>性别</label>
                                <input type="text" :value="refundOrderDetail.gender === 1 ? '男' : '女'" readonly class="readonly-input">
                            </div>
                        </div>
                        <div class="form-group-row">
                            <div class="form-group-col">
                                <label>退费金额</label>
                                <input type="text" :value="refundOrderDetail.refund_amount" readonly class="readonly-input" style="font-weight: bold; color: #e74c3c;">
                            </div>
                            <div class="form-group-col">
                                <label>提交人</label>
                                <input type="text" :value="refundOrderDetail.submitter" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>提交时间</label>
                                <input type="text" :value="refundOrderDetail.submit_time" readonly class="readonly-input">
                            </div>
                        </div>
                    </div>

                    <!-- 退费子订单列表 -->
                    <div class="refund-section">
                        <h4>退费子订单列表</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>子订单ID</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>退费金额</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in refundOrderDetail.refund_items" :key="item.id">
                                    <td>{{ item.childorder_id }}</td>
                                    <td>{{ item.goods_id }}</td>
                                    <td>{{ item.goods_name }}</td>
                                    <td style="font-weight: bold;">{{ item.refund_amount }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 退费收款分配列表 -->
                    <div class="refund-section">
                        <h4>退费收款分配列表</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>收款ID</th>
                                    <th>收款类型</th>
                                    <th>退费金额</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="payment in refundOrderDetail.refund_payments" :key="payment.id">
                                    <td>{{ payment.payment_id }}</td>
                                    <td>{{ payment.payment_type === 0 ? '常规收款' : '淘宝收款' }}</td>
                                    <td style="font-weight: bold;">{{ payment.refund_amount }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 退费信息补充 -->
                    <div v-if="refundOrderDetail.taobao_supplement || (refundOrderDetail.regular_supplements && refundOrderDetail.regular_supplements.length > 0)" class="refund-section">
                        <h4>退费信息补充</h4>

                        <!-- 淘宝退费 -->
                        <div v-if="refundOrderDetail.taobao_supplement">
                            <h5 style="font-size: 14px; font-weight: 600; margin-bottom: 10px;">淘宝退费</h5>
                            <div class="form-group-row">
                                <div class="form-group-col">
                                    <label>支付宝账号</label>
                                    <input type="text" :value="refundOrderDetail.taobao_supplement.alipay_account" readonly class="readonly-input">
                                </div>
                                <div class="form-group-col">
                                    <label>支付宝名称</label>
                                    <input type="text" :value="refundOrderDetail.taobao_supplement.alipay_name" readonly class="readonly-input">
                                </div>
                                <div class="form-group-col">
                                    <label>退费金额</label>
                                    <input type="text" :value="'￥' + refundOrderDetail.taobao_supplement.refund_amount" readonly class="readonly-input" style="font-weight: bold; color: #e74c3c;">
                                </div>
                            </div>
                        </div>

                        <!-- 常规退费 -->
                        <div v-if="refundOrderDetail.regular_supplements && refundOrderDetail.regular_supplements.length > 0" :style="{marginTop: refundOrderDetail.taobao_supplement ? '15px' : '0'}">
                            <h5 style="font-size: 14px; font-weight: 600; margin-bottom: 10px;">常规退费</h5>
                            <div v-for="(item, index) in refundOrderDetail.regular_supplements" :key="index" style="margin-bottom: 15px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px;">
                                <div style="margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">
                                    <span>{{ item.payee_entity === 0 ? '北京' : '西安' }}</span>
                                    <span style="margin-left: 10px;">{{ item.is_corporate_transfer === 1 ? '对公转账' : '非对公转账' }}</span>
                                </div>
                                <div class="form-group-row">
                                    <div class="form-group-col">
                                        <label>付款方</label>
                                        <input type="text" :value="item.payer || '-'" readonly class="readonly-input">
                                    </div>
                                    <div class="form-group-col">
                                        <label>银行账户</label>
                                        <input type="text" :value="item.bank_account || '-'" readonly class="readonly-input">
                                    </div>
                                    <div class="form-group-col">
                                        <label>退款金额</label>
                                        <input type="text" :value="'￥' + item.refund_amount" readonly class="readonly-input" style="font-weight: bold; color: #e74c3c;">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeRefundOrderDetail">关闭</button>
                </div>
            </div>
        </div>

        <!-- 申请退费弹窗 -->
        <div class="drawer-overlay" v-if="showRefundDialog" @click="closeRefundDialog">
            <div class="drawer drawer-large" @click.stop>
                <div class="drawer-header">
                    <h3>申请退费</h3>
                    <button class="close-btn" @click="closeRefundDialog">&times;</button>
                </div>
                <div class="drawer-body">
                    <!-- 基本信息区 -->
                    <div class="refund-section">
                        <h4>基本信息</h4>
                        <div class="form-group-row">
                            <div class="form-group-col">
                                <label>UID</label>
                                <input type="text" :value="refundForm.student_id" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>学生姓名</label>
                                <input type="text" :value="refundForm.student_name" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>年级</label>
                                <input type="text" :value="refundForm.grade" readonly class="readonly-input">
                            </div>
                            <div class="form-group-col">
                                <label>性别</label>
                                <input type="text" :value="refundForm.gender === 1 ? '男' : '女'" readonly class="readonly-input">
                            </div>
                        </div>
                    </div>

                    <!-- 子订单列表区 -->
                    <div class="refund-section">
                        <h4>子订单列表</h4>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>选择</th>
                                    <th>子订单ID</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>可退金额</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="item in refundForm.child_orders" :key="item.childorder_id">
                                    <td>
                                        <button class="select-btn" @click="selectChildOrderForRefund(item)"
                                                :disabled="item.available_refund <= 0">选择</button>
                                    </td>
                                    <td>{{ item.childorder_id }}</td>
                                    <td>{{ item.goods_id }}</td>
                                    <td>{{ item.goods_name }}</td>
                                    <td>{{ item.available_refund.toFixed(2) }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 待退费区 -->
                    <div class="refund-section">
                        <div class="section-header">
                            <h4>待退费区</h4>
                            <div class="section-actions">
                                <span class="refund-total">退费总额: {{ refundForm.refund_total.toFixed(2) }}</span>
                                <button class="apply-btn" @click="applyRefundTotal">应用</button>
                            </div>
                        </div>
                        <table class="data-table" v-if="refundForm.selected_refunds.length > 0">
                            <thead>
                                <tr>
                                    <th>子订单ID</th>
                                    <th>商品ID</th>
                                    <th>商品名称</th>
                                    <th>可退金额</th>
                                    <th>退费金额</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(item, index) in refundForm.selected_refunds" :key="item.childorder_id">
                                    <td>{{ item.childorder_id }}</td>
                                    <td>{{ item.goods_id }}</td>
                                    <td>{{ item.goods_name }}</td>
                                    <td>{{ item.available_refund.toFixed(2) }}</td>
                                    <td>
                                        <input type="number" v-model.number="item.refund_amount"
                                               :max="item.available_refund" min="0" step="0.01"
                                               @input="validateRefundAmount(item)" class="amount-input">
                                    </td>
                                    <td>
                                        <button class="delete-btn" @click="removeRefundItem(index)">删除</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <p v-else class="empty-message">请从上方子订单列表中选择需要退费的商品</p>
                    </div>

                    <!-- 收款列表区 -->
                    <div class="refund-section">
                        <div class="section-header">
                            <h4>收款列表</h4>
                            <div class="section-actions">
                                <span class="unallocated-amount">待分配金额: {{ refundForm.unallocated_amount.toFixed(2) }}</span>
                                <button class="apply-btn" @click="applyRefundSupplement">应用</button>
                            </div>
                        </div>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>收款ID</th>
                                    <th>收款类型</th>
                                    <th>收款金额</th>
                                    <th>收款主体</th>
                                    <th>可退金额</th>
                                    <th>退费金额</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="payment in refundForm.payments" :key="payment.payment_id + '-' + payment.payment_type">
                                    <td>{{ payment.payment_id }}</td>
                                    <td>{{ payment.payment_type === 0 ? '常规收款' : '淘宝收款' }}</td>
                                    <td>{{ payment.payment_amount }}</td>
                                    <td>{{ payment.payee_entity === 0 ? '北京' : '西安' }}</td>
                                    <td>{{ payment.available_refund.toFixed(2) }}</td>
                                    <td>
                                        <input type="number" v-model.number="payment.refund_amount"
                                               :max="payment.available_refund" min="0" step="0.01"
                                               @input="validatePaymentRefundAmount(payment)" class="amount-input">
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 退费信息补充区 -->
                    <div class="refund-section" v-if="refundForm.supplement_generated">
                        <h4>退费信息补充</h4>

                        <!-- 淘宝退费 -->
                        <div v-if="refundForm.taobao_supplement" style="margin-bottom: 20px;">
                            <h5 style="margin-bottom: 10px;">淘宝退费</h5>
                            <div class="form-group-row">
                                <div class="form-group-col">
                                    <label>支付宝账号 <span style="color: red;">*</span></label>
                                    <input type="text" v-model="refundForm.taobao_supplement.alipay_account" required>
                                </div>
                                <div class="form-group-col">
                                    <label>支付宝名称 <span style="color: red;">*</span></label>
                                    <input type="text" v-model="refundForm.taobao_supplement.alipay_name" required>
                                </div>
                                <div class="form-group-col">
                                    <label>退费金额</label>
                                    <input type="number" :value="refundForm.taobao_supplement.refund_amount.toFixed(2)" readonly class="readonly-input">
                                </div>
                            </div>
                        </div>

                        <!-- 常规退费 -->
                        <div v-if="refundForm.regular_supplements && refundForm.regular_supplements.length > 0">
                            <h5 style="margin-bottom: 10px;">常规退费</h5>
                            <div v-for="(item, index) in refundForm.regular_supplements" :key="index" style="margin-bottom: 15px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px;">
                                <div style="margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">
                                    <span>{{ item.payee_entity === 0 ? '北京' : '西安' }}</span>
                                    <span style="margin-left: 10px;">{{ item.is_corporate_transfer === 1 ? '对公转账' : '非对公转账' }}</span>
                                </div>
                                <div class="form-group-row">
                                    <div class="form-group-col">
                                        <label>付款方 {{ item.payer_readonly ? '' : '<span style="color: red;">*</span>' }}</label>
                                        <input type="text" v-model="item.payer" :readonly="item.payer_readonly" :class="{'readonly-input': item.payer_readonly}">
                                    </div>
                                    <div class="form-group-col">
                                        <label>银行账户</label>
                                        <input type="text" v-model="item.bank_account">
                                    </div>
                                    <div class="form-group-col">
                                        <label>退款金额</label>
                                        <input type="number" :value="item.refund_amount.toFixed(2)" readonly class="readonly-input">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer">
                    <button class="cancel-btn" @click="closeRefundDialog">取消</button>
                    <button class="save-btn" @click="submitRefundApplication">提交</button>
                </div>
            </div>
        </div>

        <!-- 撤销审批流确认弹窗 -->
        <div class="modal-overlay" v-if="showCancelFlowConfirm">
            <div class="modal">
                <div class="modal-header">
                    <h3>确认撤销</h3>
                    <button class="close-btn" @click="closeCancelFlowConfirm">&times;</button>
                </div>
                <div class="modal-body">
                    <p>是否确认撤销该审批流？撤销后将无法恢复。</p>
                </div>
                <div class="modal-footer">
                    <button class="cancel-btn" @click="closeCancelFlowConfirm">取消</button>
                    <button class="delete-btn" @click="doCancelFlow">确认撤销</button>
                </div>
            </div>
        </div>

        <!-- 审批详情抽屉 -->
        <div class="drawer-overlay" v-if="showApprovalDetailDrawer" @click="closeApprovalDetail">
            <div class="drawer" @click.stop>
                <div class="drawer-header">
                    <h3>审批详情</h3>
                    <button class="close-btn" @click="closeApprovalDetail">&times;</button>
                </div>
                <div class="drawer-body" v-if="currentApprovalDetail">
                    <!-- 第一行：ID和审批流ID -->
                    <div class="form-group-row">
                        <div class="form-group">
                            <label>ID</label>
                            <input type="text" :value="currentApprovalDetail.id" readonly>
                        </div>
                        <div class="form-group">
                            <label>审批流ID</label>
                            <input type="text" :value="currentApprovalDetail.approval_flow_management_id" readonly>
                        </div>
                    </div>

                    <!-- 第二行：审批流类型、发起人、发起时间 -->
                    <div class="form-group-row">
                        <div class="form-group">
                            <label>审批流类型</label>
                            <input type="text" :value="currentApprovalDetail.approval_flow_type_name" readonly>
                        </div>
                        <div class="form-group">
                            <label>发起人</label>
                            <input type="text" :value="currentApprovalDetail.flow_info?.creator_name" readonly>
                        </div>
                        <div class="form-group">
                            <label>发起时间</label>
                            <input type="text" :value="currentApprovalDetail.create_time" readonly>
                        </div>
                    </div>

                    <!-- 第三行：审批流程数轴 -->
                    <div style="margin: 30px 0;">
                        <label style="display: block; margin-bottom: 15px; font-weight: bold; color: #333;">审批流程</label>
                        <div style="display: flex; align-items: center; position: relative; padding: 0 20px;">
                            <!-- 连接线 -->
                            <div style="position: absolute; top: 15px; left: 30px; right: 30px; height: 2px; background-color: #e8e8e8; z-index: 1;"></div>

                            <!-- 节点 -->
                            <div v-for="(node, index) in currentApprovalDetail.all_nodes" :key="node.template_node_id"
                                 style="flex: 1; display: flex; flex-direction: column; align-items: center; position: relative; z-index: 2;">
                                <!-- 节点圆点 -->
                                <div :style="{
                                    width: '30px',
                                    height: '30px',
                                    borderRadius: '50%',
                                    backgroundColor: node.node_result === 0 ? '#52c41a' : (node.node_result === 1 ? '#f56c6c' : (node.node_case_id && node.node_result === null ? '#1890ff' : '#bfbfbf')),
                                    border: '3px solid white',
                                    boxShadow: '0 2px 8px rgba(0,0,0,0.15)',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    color: 'white',
                                    fontSize: '12px',
                                    fontWeight: 'bold'
                                }">
                                    {{ index + 1 }}
                                </div>
                                <!-- 节点名称 -->
                                <div style="margin-top: 8px; font-size: 12px; text-align: center; color: #666;">
                                    {{ node.node_name }}
                                </div>
                                <!-- 节点状态 -->
                                <div style="margin-top: 4px; font-size: 11px; text-align: center;"
                                     :style="{ color: node.node_result === 0 ? '#52c41a' : (node.node_result === 1 ? '#f56c6c' : (node.node_case_id && node.node_result === null ? '#1890ff' : '#bfbfbf')) }">
                                    {{ node.node_result === 0 ? '已通过' : (node.node_result === 1 ? '已驳回' : (node.node_case_id && node.node_result === null ? '审批中' : '未开始')) }}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 第四行：审批内容（退费类型） -->
                    <div v-if="currentApprovalDetail.refund_order_info" style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #333;">审批内容</label>

                        <!-- 退费基本信息 -->
                        <div class="form-group-row">
                            <div class="form-group">
                                <label>退费ID</label>
                                <input type="text" :value="currentApprovalDetail.refund_order_info.refund_order_id" readonly>
                            </div>
                            <div class="form-group">
                                <label>退费金额</label>
                                <input type="text" :value="'￥' + currentApprovalDetail.refund_order_info.refund_amount" readonly style="color: #f56c6c; font-weight: bold;">
                            </div>
                        </div>

                        <!-- 退费商品（待退费区） -->
                        <div class="form-group" v-if="currentApprovalDetail.refund_order_info.items && currentApprovalDetail.refund_order_info.items.length > 0">
                            <label>退费商品</label>
                            <table class="data-table" style="margin-top: 5px;">
                                <thead>
                                    <tr>
                                        <th>商品名称</th>
                                        <th style="width: 150px; text-align: right;">退费金额</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="item in currentApprovalDetail.refund_order_info.items" :key="item.goods_name">
                                        <td>{{ item.goods_name }}</td>
                                        <td style="text-align: right;">￥{{ item.refund_amount }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 退费途径（收款列表） -->
                        <div class="form-group" v-if="currentApprovalDetail.refund_order_info.payments && currentApprovalDetail.refund_order_info.payments.length > 0">
                            <label>退费途径</label>
                            <table class="data-table" style="margin-top: 5px;">
                                <thead>
                                    <tr>
                                        <th>收款ID</th>
                                        <th>收款类型</th>
                                        <th>收款主体</th>
                                        <th style="width: 120px; text-align: right;">原收款金额</th>
                                        <th style="width: 120px; text-align: right;">退费金额</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="payment in currentApprovalDetail.refund_order_info.payments" :key="payment.payment_id">
                                        <td>{{ payment.payment_id }}</td>
                                        <td>{{ payment.payment_type === 0 ? '常规收款' : '淘宝收款' }}</td>
                                        <td>{{ payment.payee_entity === null ? '-' : (payment.payee_entity === 0 ? '北京' : '西安') }}</td>
                                        <td style="text-align: right;">￥{{ payment.payment_amount }}</td>
                                        <td style="text-align: right; color: #f56c6c; font-weight: bold;">￥{{ payment.refund_amount }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- 退费信息补充 -->
                        <div v-if="currentApprovalDetail.refund_order_info.taobao_supplement || (currentApprovalDetail.refund_order_info.regular_supplements && currentApprovalDetail.refund_order_info.regular_supplements.length > 0)" style="margin-top: 20px;">
                            <label style="display: block; margin-bottom: 10px; font-weight: bold; color: #333;">退费信息补充</label>

                            <!-- 淘宝退费 -->
                            <div v-if="currentApprovalDetail.refund_order_info.taobao_supplement">
                                <h5 style="font-size: 14px; font-weight: 600; margin-bottom: 10px;">淘宝退费</h5>
                                <div class="form-group-row">
                                    <div class="form-group-col">
                                        <label>支付宝账号</label>
                                        <input type="text" :value="currentApprovalDetail.refund_order_info.taobao_supplement.alipay_account" readonly class="readonly-input">
                                    </div>
                                    <div class="form-group-col">
                                        <label>支付宝名称</label>
                                        <input type="text" :value="currentApprovalDetail.refund_order_info.taobao_supplement.alipay_name" readonly class="readonly-input">
                                    </div>
                                    <div class="form-group-col">
                                        <label>退费金额</label>
                                        <input type="text" :value="'￥' + currentApprovalDetail.refund_order_info.taobao_supplement.refund_amount" readonly class="readonly-input" style="font-weight: bold; color: #e74c3c;">
                                    </div>
                                </div>
                            </div>

                            <!-- 常规退费 -->
                            <div v-if="currentApprovalDetail.refund_order_info.regular_supplements && currentApprovalDetail.refund_order_info.regular_supplements.length > 0" :style="{marginTop: currentApprovalDetail.refund_order_info.taobao_supplement ? '15px' : '0'}">
                                <h5 style="font-size: 14px; font-weight: 600; margin-bottom: 10px;">常规退费</h5>
                                <div v-for="(item, index) in currentApprovalDetail.refund_order_info.regular_supplements" :key="index" style="margin-bottom: 15px; padding: 10px; border: 1px solid #e0e0e0; border-radius: 4px;">
                                    <div style="margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">
                                        <span>{{ item.payee_entity === 0 ? '北京' : '西安' }}</span>
                                        <span style="margin-left: 10px;">{{ item.is_corporate_transfer === 1 ? '对公转账' : '非对公转账' }}</span>
                                    </div>
                                    <div class="form-group-row">
                                        <div class="form-group-col">
                                            <label>付款方</label>
                                            <input type="text" :value="item.payer || '-'" readonly class="readonly-input">
                                        </div>
                                        <div class="form-group-col">
                                            <label>银行账户</label>
                                            <input type="text" :value="item.bank_account || '-'" readonly class="readonly-input">
                                        </div>
                                        <div class="form-group-col">
                                            <label>退款金额</label>
                                            <input type="text" :value="'￥' + item.refund_amount" readonly class="readonly-input" style="font-weight: bold; color: #e74c3c;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="drawer-footer" v-if="currentApprovalDetail && currentApprovalDetail.result === null">
                    <button class="cancel-btn" @click="rejectFlow">驳回</button>
                    <button class="save-btn" @click="approveFlow">通过</button>
                </div>
                <div class="drawer-footer" v-else>
                    <button class="cancel-btn" @click="closeApprovalDetail">关闭</button>
                </div>
            </div>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
